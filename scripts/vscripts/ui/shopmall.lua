LinkLuaModifier( "modifiy_shopmall_jjzc_1","lua_modifiers/mall/modifiy_shopmall_jjzc_1", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_jjzc_2","lua_modifiers/mall/modifiy_shopmall_jjzc_2", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_jjzc_3","lua_modifiers/mall/modifiy_shopmall_jjzc_3", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_jjzc_4","lua_modifiers/mall/modifiy_shopmall_jjzc_4", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_jjzc_5","lua_modifiers/mall/modifiy_shopmall_jjzc_5", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_jjzc_6","lua_modifiers/mall/modifiy_shopmall_jjzc_6", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_jjzc_7","lua_modifiers/mall/modifiy_shopmall_jjzc_7", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_jjzc_8","lua_modifiers/mall/modifiy_shopmall_jjzc_8", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_jjzc_9","lua_modifiers/mall/modifiy_shopmall_jjzc_9", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_jjzc_10","lua_modifiers/mall/modifiy_shopmall_jjzc_10", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_jjzc_11","lua_modifiers/mall/modifiy_shopmall_jjzc_11", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_jjzc_12","lua_modifiers/mall/modifiy_shopmall_jjzc_12", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_jjzc_13","lua_modifiers/mall/modifiy_shopmall_jjzc_13", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_jjzc_14","lua_modifiers/mall/modifiy_shopmall_jjzc_14", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_jjzc_15","lua_modifiers/mall/modifiy_shopmall_jjzc_15", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_jjzc_16","lua_modifiers/mall/modifiy_shopmall_jjzc_16", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_jjzc_17","lua_modifiers/mall/modifiy_shopmall_jjzc_17", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_jjzc_18","lua_modifiers/mall/modifiy_shopmall_jjzc_18", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_jjzc_19","lua_modifiers/mall/modifiy_shopmall_jjzc_19", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_jjzc_20","lua_modifiers/mall/modifiy_shopmall_jjzc_20", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_jjzc_21","lua_modifiers/mall/modifiy_shopmall_jjzc_21", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_jjzc_22","lua_modifiers/mall/modifiy_shopmall_jjzc_22", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_jjzc_23","lua_modifiers/mall/modifiy_shopmall_jjzc_23", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_zjzc_1","lua_modifiers/mall/modifiy_shopmall_zjzc_1", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_zjzc_2","lua_modifiers/mall/modifiy_shopmall_zjzc_2", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_zjzc_3","lua_modifiers/mall/modifiy_shopmall_zjzc_3", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_zjzc_4","lua_modifiers/mall/modifiy_shopmall_zjzc_4", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_zjzc_5","lua_modifiers/mall/modifiy_shopmall_zjzc_5", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_zjzc_6","lua_modifiers/mall/modifiy_shopmall_zjzc_6", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_zjzc_7","lua_modifiers/mall/modifiy_shopmall_zjzc_7", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_zjzc_8","lua_modifiers/mall/modifiy_shopmall_zjzc_8", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_zjzc_9","lua_modifiers/mall/modifiy_shopmall_zjzc_9", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_zjzc_10","lua_modifiers/mall/modifiy_shopmall_zjzc_10", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_zjzc_11","lua_modifiers/mall/modifiy_shopmall_zjzc_11", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_zjzc_12","lua_modifiers/mall/modifiy_shopmall_zjzc_12", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_zjzc_13","lua_modifiers/mall/modifiy_shopmall_zjzc_13", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_zjzc_14","lua_modifiers/mall/modifiy_shopmall_zjzc_14", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_zjzc_15","lua_modifiers/mall/modifiy_shopmall_zjzc_15", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_zjzc_16","lua_modifiers/mall/modifiy_shopmall_zjzc_16", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_zjzc_17","lua_modifiers/mall/modifiy_shopmall_zjzc_17", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_zjzc_18","lua_modifiers/mall/modifiy_shopmall_zjzc_18", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_zjzc_19","lua_modifiers/mall/modifiy_shopmall_zjzc_19", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_zjzc_20","lua_modifiers/mall/modifiy_shopmall_zjzc_20", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_zjzc_21","lua_modifiers/mall/modifiy_shopmall_zjzc_21", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_zjzc_22","lua_modifiers/mall/modifiy_shopmall_zjzc_22", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_zjzc_23","lua_modifiers/mall/modifiy_shopmall_zjzc_23", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_gjzc_1","lua_modifiers/mall/modifiy_shopmall_gjzc_1", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_gjzc_2","lua_modifiers/mall/modifiy_shopmall_gjzc_2", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_gjzc_3","lua_modifiers/mall/modifiy_shopmall_gjzc_3", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_gjzc_4","lua_modifiers/mall/modifiy_shopmall_gjzc_4", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_gjzc_5","lua_modifiers/mall/modifiy_shopmall_gjzc_5", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_gjzc_6","lua_modifiers/mall/modifiy_shopmall_gjzc_6", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_gjzc_7","lua_modifiers/mall/modifiy_shopmall_gjzc_7", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_gjzc_8","lua_modifiers/mall/modifiy_shopmall_gjzc_8", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_gjzc_9","lua_modifiers/mall/modifiy_shopmall_gjzc_9", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_gjzc_10","lua_modifiers/mall/modifiy_shopmall_gjzc_10", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_gjzc_11","lua_modifiers/mall/modifiy_shopmall_gjzc_11", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_gjzc_12","lua_modifiers/mall/modifiy_shopmall_gjzc_12", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_gjzc_13","lua_modifiers/mall/modifiy_shopmall_gjzc_13", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_gjzc_14","lua_modifiers/mall/modifiy_shopmall_gjzc_14", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_gjzc_15","lua_modifiers/mall/modifiy_shopmall_gjzc_15", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_gjzc_16","lua_modifiers/mall/modifiy_shopmall_gjzc_16", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_gjzc_17","lua_modifiers/mall/modifiy_shopmall_gjzc_17", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_gjzc_18","lua_modifiers/mall/modifiy_shopmall_gjzc_18", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_gjzc_19","lua_modifiers/mall/modifiy_shopmall_gjzc_19", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_gjzc_20","lua_modifiers/mall/modifiy_shopmall_gjzc_20", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_gjzc_21","lua_modifiers/mall/modifiy_shopmall_gjzc_21", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_gjzc_22","lua_modifiers/mall/modifiy_shopmall_gjzc_22", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_gjzc_23","lua_modifiers/mall/modifiy_shopmall_gjzc_23", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_cmzc_1","lua_modifiers/mall/modifiy_shopmall_cmzc_1", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_cmzc_2","lua_modifiers/mall/modifiy_shopmall_cmzc_2", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_cmzc_3","lua_modifiers/mall/modifiy_shopmall_cmzc_3", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_cmzc_4","lua_modifiers/mall/modifiy_shopmall_cmzc_4", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_cmzc_5","lua_modifiers/mall/modifiy_shopmall_cmzc_5", LUA_MODIFIER_MOTION_NONE )
--LinkLuaModifier( "modifiy_shopmall_cmzc_6","lua_modifiers/mall/modifiy_shopmall_cmzc_6", LUA_MODIFIER_MOTION_NONE )
--LinkLuaModifier( "modifiy_shopmall_cmzc_7","lua_modifiers/mall/modifiy_shopmall_cmzc_7", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_cmzc_8","lua_modifiers/mall/modifiy_shopmall_cmzc_8", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_cmzc_9","lua_modifiers/mall/modifiy_shopmall_cmzc_9", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_cmzc_11","lua_modifiers/mall/modifiy_shopmall_cmzc_11", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_cmzc_13","lua_modifiers/mall/modifiy_shopmall_cmzc_13", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_cmzc_15","lua_modifiers/mall/modifiy_shopmall_cmzc_15", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_cmzc_16","lua_modifiers/mall/modifiy_shopmall_cmzc_16", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_cmzc_17","lua_modifiers/mall/modifiy_shopmall_cmzc_17", LUA_MODIFIER_MOTION_NONE )

LinkLuaModifier( "modifiy_shopmall_bp_7","lua_modifiers/mall/modifiy_shopmall_bp_7", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_bp_12","lua_modifiers/mall/modifiy_shopmall_bp_12", LUA_MODIFIER_MOTION_NONE )

LinkLuaModifier( "modifiy_shopmall_tszc_1","lua_modifiers/mall/modifiy_shopmall_tszc_1", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_tszc_2","lua_modifiers/mall/modifiy_shopmall_tszc_2", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_tszc_3","lua_modifiers/mall/modifiy_shopmall_tszc_3", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_tszc_4","lua_modifiers/mall/modifiy_shopmall_tszc_4", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_tszc_5","lua_modifiers/mall/modifiy_shopmall_tszc_5", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_tszc_6","lua_modifiers/mall/modifiy_shopmall_tszc_6", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_tszc_9","lua_modifiers/mall/modifiy_shopmall_tszc_9", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifiy_shopmall_tszc_10","lua_modifiers/mall/modifiy_shopmall_tszc_10", LUA_MODIFIER_MOTION_NONE )
if Shopmall == nil then
    Shopmall = {}
    require("ui.shopquest")
    Shopmall.Playermall = {}
    Shopmall.unitzc = {}
    Shopmall.unit_battlepass = {}
    Shopmall.unit_quest = {}  --初始化任务
    Shopmall.finish_quest = {}  --存多个玩家多个任务
    Shopmall.playerzc = {}  --存多个玩家多个任务
    Shopmall.herotype = {}  --存玩家对应英雄类型
    setmetatable(Shopmall,Shopmall)
    --price_magic 仙石价格
    --price_jing 晶石价格
    --maxtimes 最多使用次数
    --stack数量
    --limit 限制使用条件
    Shopmall.list={
        shopmall_1={
            price_magic=4800,--4800
            reward={},
            catalog1="certificate",
            catalog2="pass",
            validDays=31,
            canuse=false,
        },
        shopmall_2  ={ --月卡
            price_magic=1500,--1500
            reward={
                Attr_jqjc=20,
                Attr_jyjc=20,
                Giveitem={"item_xhp_wzts_1"},
            },--金钱获取+20%，经验获取+20%        地图经验获取+30%(所有的地图经验获取率都是 加法)  英雄随机次数+1   出门给予一本1级天书  item_xhp_wzts_1
            catalog1="certificate",
            catalog2="plus",
            validDays=31,
            canuse=false,
        },
        shopmall_45  ={ --季卡
            price_magic=4000,
            reward={
                Attr_jqjc=20,
                Attr_jyjc=20,
                Giveitem={"item_xhp_wzts_1"},
            },--金钱获取+20%，经验获取+20%        地图经验获取+30%(所有的地图经验获取率都是 加法)  英雄随机次数+1   出门给予一本1级天书  item_xhp_wzts_1
            catalog1="certificate",
            catalog2="plus",
            validDays=93,
            canuse=false,
        },
        shopmall_46  ={ --永久卡
            price_magic=15000,
            reward={
                Attr_jqjc=20,
                Attr_jyjc=20,
                Giveitem={"item_xhp_wzts_1"},
            },--金钱获取+20%，经验获取+20%        地图经验获取+30%(所有的地图经验获取率都是 加法)  英雄随机次数+1   出门给予一本1级天书  item_xhp_wzts_1
            catalog1="certificate",
            catalog2="plus",
            validDays=-1,
            canuse=false,
        },
        shopmall_3 ={ ---技能达人 	价格：200仙石	  时间：永久    作用：出门给与 1 本秘诀	  item_mj_random_2
            price_magic=200,
            reward={  Giveitem={"item_mj_random_2"},       },
            catalog1="certificate",
            canuse=false,
        },
        shopmall_4 ={--聚宝盆	价格：5800仙石      时间：永久	        作用：金钱加成+30%    jqjc              经验加成+30% 	  jyjc
            price_magic=5800,
            reward={Attr_jqjc=30, Attr_jyjc=30, },
            catalog1="certificate",
            notSale=true, 
            canuse=false,
        },
        shopmall_5={--初级赞助			价格：600仙石        时间：永久	    作用：初始三维+10       初始杀敌数+100   sds              初始金钱+1000
            price_magic=600,
            reward={Set_AllPRO=10,Attr_sds=100,Givegold=1000},
            catalog1="certificate",
            catalog2="vip",
            notSale=true,
            canuse=false,   
        },
        shopmall_6={--中级赞助			价格：3000仙石        时间：永久	  作用：初始三维+15           初始杀敌数+100   金钱获取+5%	jqjc  经验获取+5%	jyjc      最终伤害+3%	zzsh
            price_magic=3000,
            reward={Set_AllPRO=15,Attr_bfbtsqsx=3,Attr_sds=100,Attr_jqjc=5, Attr_jyjc=5,Attr_zzsh=3,},
            catalog1="certificate",
            catalog2="vip",
            notSale=true,
            canuse=false,   
        },
        shopmall_7={--高级赞助	价格：8800仙石	  时间：永久	 作用：初始三维+20      三维+5%   金钱获取+10%	经验获取+10%      每10秒杀敌数+10     减伤系数+20 	shjm   最终伤害+5% 	zzsh
            price_magic=8800,
            reward={Set_AllPRO=20,Attr_bfbtsqsx=10,Attr_msmjsds=10,Attr_jqjc=12, Attr_jyjc=12,Attr_shjm=20,Attr_zzsh=5,Attr_treasure=3,},
            catalog1="certificate",
            catalog2="vip",
            canuse=false,
        },
        shopmall_53={--白银会员
            price_jing=680000,
            reward={Set_AllPRO=30,Attr_bfbtsqsx=10,Attr_xyz=10,Attr_tmz=30},
            catalog1="certificate",
            catalog2="vip",
       --     notSale=true,
            canuse=false, 
        },
        shopmall_54={--黄金会员
            price_jing=3000000,
            reward={Set_AllPRO=50,Attr_bfbtsqsx=20,Attr_xyz=15,Attr_tmz=50},
            catalog1="certificate",
            catalog2="vip",
        --    notSale=true,
            canuse=false, 
        },
        shopmall_87={--钻石会员
            price_jing=10000000,
            reward={Attr_bfbtsqsx=20,Attr_tmz3=80,Attr_jnmjts=0.1},
            catalog1="certificate",
            catalog2="vip",
        --    notSale=true,
            canuse=false, 
        },
        shopmall_97={--黑曜石会员
            price_jing=10000000,
            reward={Attr_bfbtsqsx=20,Attr_tmz3=80,Attr_jnmjts=0.1},
            catalog1="certificate",
            catalog2="vip",
            notSale=true,
            canuse=false, 
        },
        shopmall_98={--第一赛季通行证属性
            price_jing=1000,
            reward={Givegold=1000,Set_zl=20,Set_mj=25,Set_ll=30,Attr_sds=50,Attr_wlbjsh=20,Attr_mfbjsh=20,Attr_wlbjgl=2,Attr_mfbjgl=2,Attr_grjndj=2,Attr_fjsh=2,Attr_zzsh=2,Attr_jqjc=3,Attr_jyjc=3},
            catalog1="certificate",
            catalog2="vip",
            notSale=true,
            canuse=false, 
        },
        shopmall_91={--V10000
            price_magic=100000,
            reward={Attr_zzsh=20,Attr_tmz4=100,Attr_jnmjts=0.2},
            catalog1="certificate",
            catalog2="vip",
            notSale=true,
            canuse=false, 
        },
        shopmall_92={--V20000
            price_magic=100000,
            reward={Attr_zzsh=20,Attr_tmz4=100,Attr_jnmjts=0.2},
            catalog1="certificate",
            catalog2="vip",
            notSale=true,
            canuse=false, 
        },
        shopmall_93={--V30000
            price_magic=100000,
            reward={Attr_zzsh=20,Attr_tmz4=100,Attr_jnmjts=0.2},
            catalog1="certificate",
            catalog2="vip",
            notSale=true,
            canuse=false, 
        },
        shopmall_94={--V50000
            price_magic=100000,
            reward={Attr_zzsh=20,Attr_tmz4=100,Attr_jnmjts=0.2},
            catalog1="certificate",
            catalog2="vip",
            notSale=true,
            canuse=false, 
        },
        shopmall_95={--V70000
            price_magic=100000,
            reward={Attr_zzsh=20,Attr_tmz4=100,Attr_jnmjts=0.2},
            catalog1="certificate",
            catalog2="vip",
            notSale=true,
            canuse=false, 
        },
        shopmall_96={--V100000
            price_magic=100000,
            reward={Attr_zzsh=20,Attr_tmz4=100,Attr_jnmjts=0.2},
            catalog1="certificate",
            catalog2="vip",
            notSale=true,
            canuse=false, 
        },
        shopmall_8={--基础专长礼包		价格：2000仙石     时间：永久    作用：基础专长点数+3      每次开局从基础专长库里随机选取三个不重复的专长添加给英雄       
            price_magic=2000,
            reward={Set_jjzc=3},
            catalog1="certificate",
            catalog2="rune",
            canuse=false,
        },
        shopmall_9={--      中级专长礼包		价格：8000仙石             时间：永久              作用：中级专长点数+1           每次开局从中级专长库里随机选取1个不重复的专长添加给英雄       
            price_jing=80000,
            reward={Set_zjzc=1},
            catalog1="certificate",
            catalog2="rune",
            canuse=false,
           -- notSale=true,   
        },
        shopmall_49={--      中级专长礼包      价格：8000仙石             时间：永久              作用：中级专长点数+1           每次开局从中级专长库里随机选取1个不重复的专长添加给英雄       
            price_jing=8000,
            reward={Set_zjzc=1},
            catalog1="certificate",
            catalog2="rune",
            notSale=true,
            canuse=false,   
        },
        shopmall_50={--      中级专长礼包      价格：8000仙石             时间：永久              作用：中级专长点数+1           每次开局从中级专长库里随机选取1个不重复的专长添加给英雄       
            price_jing=8000,
            reward={Set_zjzc=1},
            catalog1="certificate",
            catalog2="rune",
            notSale=true,
            canuse=false,   
        },
        shopmall_10={--高级专长礼包		价格：20000仙石   时间：永久    作用：高级专长点数+1       每次开局从高级专长库里随机选取1个不重复的专长添加给英雄        
            price_jing=200000, 
            reward={Set_gjzc=1},
            catalog1="certificate",
            catalog2="rune",
            canuse=false,
           -- notSale=true,   
        },
        shopmall_51={--高级专长礼包       价格：20000仙石   时间：永久    作用：高级专长点数+1       每次开局从高级专长库里随机选取1个不重复的专长添加给英雄        
            price_jing=20000, 
            reward={Set_gjzc=1},
            catalog1="certificate",
            catalog2="rune",
            notSale=true,
            canuse=false,   
        },
        shopmall_52={--高级专长礼包       价格：20000仙石   时间：永久    作用：高级专长点数+1       每次开局从高级专长库里随机选取1个不重复的专长添加给英雄        
            price_jing=20000, 
            reward={Set_gjzc=1},
            catalog1="certificate",
            catalog2="rune",
            notSale=true,
            canuse=false,   
        },
        shopmall_11={--超魔专长礼包		价格：0	仙石 (暂无，不需要弄)    时间：永久   作用：每次开局从超魔专长库里随机选取1个专长添加给英雄  
             price_jing=1000000, 
             reward={Set_cmzc=1},
             catalog1="certificate",
             catalog2="rune",
             canuse=false,     
        --    notSale=true,   
        },
        shopmall_55={--超魔专长礼包        
             price_jing=4000000, 
             reward={Set_cmzc=1},
             catalog1="certificate",
             catalog2="rune",     
         --    notSale=true,
             canuse=false,   
        },
        shopmall_56={--超魔专长礼包        
             price_jing=0, 
             reward={Set_cmzc=1},
             catalog1="certificate",
             catalog2="rune",     
             notSale=true,
             canuse=false,   
        },
        shopmall_12={--特殊专长礼包		价格：0	仙石(暂无，不需要弄)      时间：永久   作用：每次开局从特殊专长库里随机选取1个专长添加给英雄
            price_jing=5000000,
            reward={Set_tszc=1},
            catalog1="certificate",
            catalog2="rune",
            canuse=false,
         --   notSale=true,
        },
        shopmall_57={--特殊专长礼包     
            price_jing=20000000,
            reward={Set_tszc=1},
            catalog1="certificate",
            catalog2="rune",
        --    notSale=true,
            canuse=false,
        },
        shopmall_58={--特殊专长礼包     
            price_jing=5000000,
            reward={Set_tszc=1},
            catalog1="certificate",
            catalog2="rune",
            notSale=true,
            canuse=false,
        },
        shopmall_13={--技能秘诀--消耗(可堆叠)     价格：100晶石    时间: 单局消耗      作用：出门给与 1 本秘诀	  item_mj_random_2      说明：每局只能使用 5 次
            price_jing=100,
            reward={Giveitem={"item_mj_random_2"},},
            maxtimes=5,
            stack=0,
            catalog1="consumable",
            canuse=true, 
        },
        shopmall_14={--宝物--消耗(可堆叠)      价格：2000晶石     时间：单局消耗     作用：在商城背包里面使用, 给与 1 件宝物	  item_bw_1     说明：每局只能使用 1 次
            price_jing=5000,
            reward={Giveitem={"item_bw_1"},},
            maxtimes=1,
            stack=0,
            catalog1="consumable",
            canuse=true,  
            
        },
        shopmall_15={--基础专长--消耗(可堆叠)       价格：500晶石      时间：单局消耗      作用：在商城背包里面使用给予 1个随机基础专长      说明：每局只能使用 3 次
            price_jing=250,
            reward={Set_jjzc=1},
            canuse=true, 
            stack=0,
            maxtimes=3,
            catalog1="consumable",
            catalog2="rune",
            
        },
        shopmall_16={--中级专长--消耗(可堆叠)		      价格：1000晶石   时间：单局消耗    作用：在商城背包里面使用给予 1个随机中级专长      说明：每局只能使用1次
            price_jing=500,
            reward={Set_zjzc=1},
            stack=0,
            maxtimes=2,
            catalog1="consumable",
            catalog2="rune",
            canuse=true, 
        },
        shopmall_17={--高级专长--消耗(可堆叠)		   价格：2000晶石    时间：单局消耗     作用：在商城背包里面使用给予 1个随机高级专长       说明：每局只能使用1次
            price_jing=1000,
            reward={Set_gjzc=1},
            stack=0,
            maxtimes=1,
            catalog1="consumable",
            catalog2="rune",
            canuse=true, 
        },
        shopmall_47={--超魔专长--消耗(可堆叠)           价格：2000晶石    时间：单局消耗     作用：在商城背包里面使用给予 1个随机高级专长       说明：每局只能使用1次
            price_jing=2500,
            reward={Set_cmzc=1},
            stack=0,
            maxtimes=1,
            catalog1="consumable",
            catalog2="rune",
            canuse=true, 
        },
        shopmall_48={--特殊专长--消耗(可堆叠)           价格：2000晶石    时间：单局消耗     作用：在商城背包里面使用给予 1个随机高级专长       说明：每局只能使用1次
            price_jing=10000,
            reward={Set_tszc=1},
            stack=0,
            maxtimes=1,
            catalog1="consumable",
            catalog2="rune",
            canuse=true, 
        },
        shopmall_18={--战吼药剂(可堆叠)      消耗 	价格：500晶石             时间：单局消耗        作用：攻击力+50% 	作用范围9999码		持续30S	 	CD：1200s
            price_jing=200,
            reward={Set_yaoji={"1_1"}},
            stack=0,
         	catalog1="consumable",
            catalog2="drug",
            cooldown=1200,
            canuse=true, 
        },
        shopmall_19={--狂暴药剂(可堆叠)	    消耗 	价格：500晶石          时间：单局消耗         作用：攻击速度+50 	作用范围9999码		持续30S		CD：1200s
            price_jing=200,
            reward={Set_yaoji={"1_2"}},
            stack=0,
            catalog1="consumable",
            catalog2="drug",
            cooldown=1200,
            canuse=true, 
        },
        shopmall_20={--秘术药剂(可堆叠)	    消耗 	价格：500晶石              时间：单局消耗          作用：技能伤害+20% 	作用范围9999码		持续30S		CD：1200s
            price_jing=500,
            reward={Set_yaoji={"1_3"}},
            stack=0,
            cooldown=1200,
            catalog1="consumable",
            catalog2="drug",
            canuse=true, 
        },
        shopmall_21={--       潜能药剂(可堆叠)	            消耗 	价格：500晶石            时间：单局消耗            作用：冷却缩减-20% 	作用范围9999码		持续30S		CD：1200s
            price_jing=500,
            reward={Set_yaoji={"1_4"}},
            stack=0,
            cooldown=1200,
            catalog1="consumable",
            catalog2="drug",
            canuse=true, 
        },
        shopmall_22={--     守护药剂(可堆叠)	           消耗 	价格：500晶石                  时间：单局消耗        作用：减伤系数+50 	作用范围9999码		持续30S		CD：1200s
            price_jing=200,
           reward={Set_yaoji={"1_5"}},
            stack=0,
            cooldown=1200,
            catalog1="consumable",
            catalog2="drug",
            canuse=true, 
        },
        shopmall_23={--二阶紫色通用装备宝箱(可堆叠)		      价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=2000,
            reward={Set_item={"2_4_5"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_2",
            canuse=true, 
        },
        shopmall_24={--二阶橙色通用装备宝箱(可堆叠)	       价格：10000晶石      时间：单局消耗     作用：在商城背包里面随机给予一件 橙色或以上品质的存档装备       说明：地图等级大于5级才可以购买
            price_jing=10000,
            reward={Set_item={"2_5_5"},},
            stack=0,
            limit={maplevel=5},
            catalog1="chest",
            catalog2="equip_2",
            notSale=true,
            canuse=true, 
        },
        shopmall_25={--二阶金色通用装备宝箱(可堆叠)		      价格：50000晶石       时间：单局消耗      作用：在商城背包里面随机给予一件 金色或以上品质的存档装备        说明：地图等级大于6级才可以购买
            price_jing=50000,
            reward={Set_item={"2_6_5"},},
            stack=0,
            limit={maplevel=6},
            catalog1="chest",
            catalog2="equip_2",
            notSale=true,
            canuse=true, 
        },
        shopmall_26={--三阶紫色通用装备宝箱(可堆叠)		     价格：20000晶石      时间：单局消耗     作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备        说明：地图等级大于7级才可以购买
            price_jing=10000,
            reward={Set_item={"3_4_5"}},
            stack=0,
            limit={maplevel=7},
            catalog1="chest",
            catalog2="equip_3",
            canuse=true, 
            notSale=true,
        },
        shopmall_27={--三阶橙色通用装备宝箱(可堆叠)	      价格：100000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 橙色或以上品质的存档装备       说明：地图等级大于8级才可以购买
            price_jing=50000,
            reward={Set_item={"3_5_5"}},
            stack=0,
            limit={maplevel=8},
            catalog1="chest",
            catalog2="equip_3",
            notSale=true,
            canuse=true, 
        },       
        shopmall_28={--三阶金色通用装备宝箱(可堆叠)		     价格：500000晶石      时间：单局消耗       作用：在商城背包里面随机给予一件 金色或以上品质的存档装备       说明：地图等级大于10级才可以购买
            price_jing=200000,
            reward={Set_item={"3_6_5"}},
            stack=0,
            limit={maplevel=10},
            catalog1="chest",
            catalog2="equip_3",
            notSale=true,
            canuse=true, 
        },
        shopmall_29={--二阶紫色武器装备宝箱(可堆叠)            价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=2000,
            reward={Set_item={"2_4_1"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_2",
            notSale=true,
            canuse=true, 
        },
        shopmall_30={--二阶紫色防具装备宝箱(可堆叠)            价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=2000,
            reward={Set_item={"2_4_2"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_2",
            notSale=true,
            canuse=true, 
        },
        shopmall_31={--二阶紫色首饰装备宝箱(可堆叠)            价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=2000,
            reward={Set_item={"2_4_3"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_2",
            notSale=true,
            canuse=true, 
        },
        shopmall_32={--二阶紫色特殊装备宝箱(可堆叠)            价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=30000,
            reward={Set_item={"2_4_4"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_2",
            notSale=true,
            canuse=true, 
        },
        shopmall_33={--三阶紫色武器装备宝箱(可堆叠)            价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=20000,
            reward={Set_item={"3_4_1"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_3",
            notSale=true,
            canuse=true, 
        },
        shopmall_34={--三阶紫色防具装备宝箱(可堆叠)            价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=20000,
            reward={Set_item={"3_4_2"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_3",
            notSale=true,
            canuse=true, 
        },
        shopmall_35={--三阶紫色首饰装备宝箱(可堆叠)            价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=20000,
            reward={Set_item={"3_4_3"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_3",
            notSale=true,
            canuse=true, 
        },
        shopmall_36={--三阶紫色特殊装备宝箱(可堆叠)            价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=120000,
            reward={Set_item={"3_4_4"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_3",
            notSale=true,
            canuse=true, 
        },
        shopmall_37={--三阶橙色武器装备宝箱(可堆叠)            价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=100000,
            reward={Set_item={"3_5_1"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_3",
            notSale=true,
            canuse=true, 
        },
        shopmall_38={--三阶橙色防具装备宝箱(可堆叠)            价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=100000,
            reward={Set_item={"3_5_2"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_3",
            notSale=true,
            canuse=true, 
        },
        shopmall_39={--三阶橙色首饰装备宝箱(可堆叠)            价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=100000,
            reward={Set_item={"3_5_3"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_3",
            notSale=true,
            canuse=true, 
        },
        shopmall_40={--三阶橙色特殊装备宝箱(可堆叠)            价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=1000000,
            reward={Set_item={"3_5_4"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_3",
            notSale=true,
            canuse=true, 
        },
        shopmall_41={--三阶金色武器装备宝箱(可堆叠)            价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=500000,
            reward={Set_item={"3_6_1"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_3",
            notSale=true,
            canuse=true, 
        },
        shopmall_42={--三阶金色防具装备宝箱(可堆叠)            价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=500000,
            reward={Set_item={"3_6_2"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_3",
            notSale=true,
            canuse=true, 
        },
        shopmall_43={--三阶金色首饰装备宝箱(可堆叠)            价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=500000,
            reward={Set_item={"3_6_3"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_3",
            notSale=true,
            canuse=true, 
        },
        shopmall_44={--三阶金色特殊装备宝箱(可堆叠)            价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=5000000,
            reward={Set_item={"3_6_4"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_3",
            notSale=true,
            canuse=true, 
        },
        shopmall_cw_1_1={--宠物
            price_magic=2000,
            reward={Set_courier="cw_1_1"},
            catalog1="visual",
            catalog2 = "pet",
            stack=0,
            canuse=true, 
        },
        shopmall_cw_1_2={--
            price_magic=2000,
            reward={Set_courier="cw_1_2"},
            catalog1="visual",
            catalog2 = "pet",
            stack=0,
            canuse=true, 
        },
        shopmall_cw_1_3={--
            price_magic=2000,
            reward={Set_courier="cw_1_3"},
            catalog1="visual",
            catalog2 = "pet",
            stack=0,
            canuse=true, 
        },
        shopmall_cw_3_11={--
            price_magic=18000,
            reward={Set_courier="cw_3_11"},
            catalog1="visual",
            catalog2 = "pet",
            stack=0,
            notSale=true,
            canuse=true, 
        },
        shopmall_cw_4_22={--
            price_magic=10000,
            reward={Set_courier="cw_4_22"},
            catalog1="visual",
            catalog2 = "pet",
            stack=0,
         --   notSale=true,
            canuse=true, 
        },
        shopmall_cw_5_22={--
            price_magic=30000,
            reward={Set_courier="cw_5_22"},
            catalog1="visual",
            catalog2 = "pet",
            stack=0,
        --    notSale=true,
            canuse=true, 
        },
        shopmall_cw_6_22={--
            price_magic=80000,
            reward={Set_courier="cw_6_22"},
            catalog1="visual",
            catalog2 = "pet",
            stack=0,
        --    notSale=true,
            canuse=true, 
        },
        shopmall_cw_1_101={--
            price_magic=2000,
            reward={Set_courier="cw_1_101"},
            catalog1="visual",
            catalog2 = "pet",
            stack=0,
            notSale=true,
            canuse=true, 
        },
        shopmall_cw_1_201={--
            price_magic=2000,
            reward={Set_courier="cw_1_201"},
            catalog1="visual",
            catalog2 = "pet",
            stack=0,
            notSale=true,
            canuse=true, 
        },
        shopmall_cw_1_102={--
            price_magic=2000,
            reward={Set_courier="cw_1_102"},
            catalog1="visual",
            catalog2 = "pet",
            stack=0,
            notSale=true,
            canuse=true, 
        },
        shopmall_cw_1_202={--
            price_magic=2000,
            reward={Set_courier="cw_1_202"},
            catalog1="visual",
            catalog2 = "pet",
            stack=0,
            notSale=true,
            canuse=true, 
        },
        shopmall_gh_1_1={--光环
            price_magic=2000,
            reward={Set_gh="gh_1_1"},
            catalog1="visual",
            catalog2 = "aura",
            stack=0,
            notSale=true,
            canuse=true, 
        },
        shopmall_gh_1_2={--
            price_magic=2000,
            reward={Set_gh="gh_1_2"},
            catalog1="visual",
            catalog2 = "aura",
            stack=0,
            notSale=true,
            canuse=true, 
        },
        shopmall_gh_1_3={--
            price_magic=2000,
            reward={Set_gh="gh_1_3"},
            catalog1="visual",
            catalog2 = "aura",
            stack=0,
            notSale=true,
            canuse=true, 
        },
        shopmall_gh_1_4={--
            price_magic=2000,
            reward={Set_gh="gh_1_4"},
            catalog1="visual",
            catalog2 = "aura",
            stack=0,
            notSale=true,
            canuse=true, 
        },
        shopmall_gh_1_101={--
            price_magic=2000,
            reward={Set_gh="gh_1_101"},
            catalog1="visual",
            catalog2 = "aura",
            stack=0,
            notSale=true,
            canuse=true, 
        },
        shopmall_gh_1_201={--
            price_magic=2000,
            reward={Set_gh="gh_1_201"},
            catalog1="visual",
            catalog2 = "aura",
            stack=0,
            notSale=true,
            canuse=true, 
        },
        shopmall_gh_1_102={--
            price_magic=99999,
            reward={Set_gh="gh_1_102"},
            catalog1="visual",
            catalog2 = "aura",
            stack=0,
            notSale=true,
            canuse=true, 
        },
        shopmall_gh_1_202={--
            price_magic=999999,
            reward={Set_gh="gh_1_202"},
            catalog1="visual",
            catalog2 = "aura",
            stack=0,
            notSale=true,
            canuse=true, 
        },
        shopmall_ch_1_1={--光环
            price_magic=2000,
            reward={Set_ch="ch_1_1"},
            catalog1="visual",
            catalog2 = "title",
            stack=0,
            notSale=true,
            canuse=true, 
        },
        shopmall_ch_1_2={--
            price_magic=2000,
            reward={Set_ch="ch_1_2"},
            catalog1="visual",
            catalog2 = "title",
            stack=0,
            notSale=true,
            canuse=true, 
        },
        shopmall_ch_1_3={--
            price_magic=2000,
            reward={Set_ch="ch_1_3"},
            catalog1="visual",
            catalog2 = "title",
            stack=0,
            notSale=true,
            canuse=true, 
        },
        shopmall_ch_1_4={--
            price_magic=2000,
            reward={Set_ch="ch_1_4"},
            catalog1="visual",
            catalog2 = "title",
            stack=0,
            notSale=true,
            canuse=true, 
        },
        shopmall_ch_2_13={--
            price_magic=2000,
            reward={Set_ch="ch_2_13"},
            catalog1="visual",
            catalog2 = "title",
            stack=0,
            notSale=true,
            canuse=true, 
        },
        shopmall_ch_3_13={--
            price_magic=2000,
            reward={Set_ch="ch_3_13"},
            catalog1="visual",
            catalog2 = "title",
            stack=0,
            notSale=true,
            canuse=true, 
        },
        shopmall_ch_4_13={--
            price_magic=2000,
            reward={Set_ch="ch_4_13"},
            catalog1="visual",
            catalog2 = "title",
            stack=0,
            notSale=true,
            canuse=true, 
        },
        shopmall_ch_2_14={--
            price_jing=300000,
            reward={Set_ch="ch_2_14"},
            catalog1="visual",
            catalog2 = "title",
            stack=0,
--            notSale=true,
            canuse=true, 
        },
        shopmall_ch_3_14={--
            price_jing=900000,
            reward={Set_ch="ch_3_14"},
            catalog1="visual",
            catalog2 = "title",
            stack=0,
--            notSale=true,
            canuse=true, 
        },
        shopmall_ch_4_14={--
            price_jing=1800000,
            reward={Set_ch="ch_4_14"},
            catalog1="visual",
            catalog2 = "title",
            stack=0,
--            notSale=true,
            canuse=true, 
        },
        shopmall_ch_5_14={--
            price_magic=10000,
            reward={Set_ch="ch_5_14"},
            catalog1="visual",
            catalog2 = "title",
            stack=0,
--            notSale=true,
            canuse=true, 
        },
        shopmall_ch_6_14={--
            price_magic=30000,
            reward={Set_ch="ch_6_14"},
            catalog1="visual",
            catalog2 = "title",
            stack=0,
--            notSale=true,
            canuse=true, 
        },
        shopmall_ch_7_14={--
            price_magic=80000,
            reward={Set_ch="ch_7_14"},
            catalog1="visual",
            catalog2 = "title",
            stack=0,
--            notSale=true,
            canuse=true, 
        },
        shopmall_ch_4_22={--
            price_jing=99999999,
            reward={Set_ch="ch_4_22"},
            catalog1="visual",
            catalog2 = "title",
            stack=0,
            notSale=true,
            canuse=true, 
        },
        shopmall_ch_5_22={--
            price_jing=99999999,
            reward={Set_ch="ch_5_22"},
            catalog1="visual",
            catalog2 = "title",
            stack=0,
            notSale=true,
            canuse=true, 
        },
        shopmall_ch_6_22={--
            price_jing=99999999,
            reward={Set_ch="ch_6_22"},
            catalog1="visual",
            catalog2 = "title",
            stack=0,
            notSale=true,
            canuse=true, 
        },
        shopmall_ch_1_101={--
            price_magic=2000,
            reward={Set_ch="ch_1_101"},
            catalog1="visual",
            catalog2 = "title",
            stack=0,
            notSale=true,
            canuse=true, 
        },
        shopmall_ch_1_201={--
            price_magic=2000,
            reward={Set_ch="ch_1_201"},
            catalog1="visual",
            catalog2 = "title",
            stack=0,
            notSale=true,
            canuse=true, 
        },
        shopmall_59 ={ ---1级神秘宝物书
            price_jing=388000,
            reward={  Giveitem={"item_smbw_1"},},
            catalog1="certificate",  
            canuse=false,  
          --  notSale=true,   
        },
        shopmall_60 ={ ---2级神秘宝物书
            price_jing=1688888,
            reward={  Giveitem={"item_smbw_2"},},
            catalog1="certificate",   
            canuse=false, 
        --    notSale=true,   
        },
        shopmall_61 ={ ---3级神秘宝物书
            price_jing=12000000,
            reward={  Giveitem={"item_smbw_3"},},
            catalog1="certificate",   
        --    notSale=true, 
            canuse=false,   
        },
        shopmall_62 ={ ---4级神秘宝物书
            price_jing=200,
            reward={  Giveitem={"item_smbw_4"},},
            catalog1="certificate",   
            notSale=true,
            canuse=false,    
        },
        shopmall_63 ={ ---11阶能量之心凭证
            price_jing=466666,
            reward={Attr_nlzx10=1},
            catalog1="certificate",
            canuse=false,    
         --   notSale=true,   
        },
        shopmall_64 ={ ---12阶能量之心凭证
            price_jing=2222222,
            reward={Attr_nlzx11=1},
            catalog1="certificate",  
            canuse=false,  
         --   notSale=true,   
        },
        shopmall_65 ={ ---13阶能量之心凭证
            price_jing=6666666,
            reward={Attr_nlzx12=1},
            catalog1="certificate",  
            canuse=false,  
          --  notSale=true,   
        },
        shopmall_66 ={ ---14阶能量之心凭证
            price_jing=20000000,
            reward={Attr_nlzx13=1},
            catalog1="certificate", 
            canuse=false,   
          --  notSale=true,   
        },
        shopmall_67 ={ ---吞噬卡
            price_jing=888888,
            reward={  Giveitem={"item_xhp_tssq_2"},},
            catalog1="certificate",
            canuse=false,    
          --  notSale=true,   
        },
        shopmall_sstone_2={--     2阶强化石
            price_jing=100,
            reward={},
            stack=0,
            catalog1="consumable",
            catalog2="enhance",
            canuse=false,    
        },
        shopmall_sstone_3={--     3阶强化石
            price_jing=200,
            reward={},
            stack=0,
            catalog1="consumable",
            catalog2="enhance",
            canuse=false,    
        },
        shopmall_sstone_4={--     4阶强化石
            price_jing=400,
            reward={},
            stack=0,
            catalog1="consumable",
            catalog2="enhance",
            canuse=false,    
        },
        shopmall_sstone_5={--     5阶强化石
            price_magic=10,
            price_jing=800,
            reward={},
            stack=0,
            catalog1="consumable",
            catalog2="enhance",
            canuse=false,    
        },
        shopmall_sstone_6={--     6阶强化石
            price_magic=20,
            price_jing=1600,
            reward={},
            stack=0,
            catalog1="consumable",
            catalog2="enhance",
            canuse=false,    
        },
        shopmall_sstone_7={--     7阶强化石
            price_magic=30,
            price_jing=3200,
            reward={},
            stack=0,
            catalog1="consumable",
            catalog2="enhance",
          --  notSale=true,
            canuse=false,    
        },
        shopmall_sstone_8={--     8阶强化石
            price_magic=32,
            price_jing=4800,
            reward={},
            stack=0,
            catalog1="consumable",
            catalog2="enhance",
          --  notSale=true,
            canuse=false,    
        },
        shopmall_sstone_9={--     9阶强化石
            price_magic=34,
            price_jing=7200,
            reward={},
            stack=0,
            catalog1="consumable",
            catalog2="enhance",
          --  notSale=true,
            canuse=false,    
        },
        shopmall_xlstone_1={--     1阶洗练石
            price_magic=1000,
            reward={},
            stack=0,
            catalog1="consumable",
            catalog2="enhance",
            notSale=true,
            canuse=false,    
        },
        shopmall_czstone_1={--     1阶重铸石
            price_magic=10000,
            reward={},
            stack=0,
            catalog1="consumable",
            catalog2="enhance",
            notSale=true,
            canuse=false,    
        },
        shopmall_68 ={ ---征战钥匙
            price_magic=300,
            price_jing=15000,
            reward={},
            catalog1="chest",
            catalog2="normal_1", 
            stack=0,
         	notSale=false,
            canuse=false,    
        },
        shopmall_69={--测试
            price_jing=30000000,
            reward={Attr_tmz2=100},
          -- catalog1="certificate",
            --catalog2="vip",
            notSale=true,
            canuse=false, 
        },
        shopmall_82={--测试
            price_jing=30000000,
            reward={Attr_tmz4=50}, 
          -- catalog1="certificate",
            --catalog2="vip",
            notSale=true,
            canuse=false, 
        },
        shopmall_83={--测试
            price_jing=30000000,
            reward={Attr_tmz4=100},
          -- catalog1="certificate",
            --catalog2="vip",
            notSale=true,
            canuse=false, 
        },
        shopmall_84={--测试
            price_jing=30000000,
            reward={Attr_tmz4=200},
          -- catalog1="certificate",
            --catalog2="vip",
            notSale=true,
            canuse=false, 
        },
        shopmall_85={--测试
            price_jing=30000000,
            reward={Attr_tmz4=300},
          -- catalog1="certificate",
            --catalog2="vip",
            notSale=true,
            canuse=false, 
        },
        shopmall_86={--测试
            price_jing=30000000,
            reward={Attr_tmz4=500},
          -- catalog1="certificate",
            --catalog2="vip",
            notSale=true,
            canuse=false, 
        },
        shopmall_88 ={ ---2级征战钥匙
            price_magic=999999,
            reward={},
            catalog1="chest",
            catalog2="normal_1", 
            stack=0,
            notSale=true,
            canuse=false,    
        },
        shopmall_89 ={ ---3级征战钥匙
            price_magic=999999,
            reward={},
            catalog1="chest",
            catalog2="normal_1", 
            stack=0,
            notSale=true,
            canuse=false,    
        },
        shopmall_90 ={ ---4级征战钥匙
            price_magic=999999,
            reward={},
            catalog1="chest",
            catalog2="normal_1", 
            stack=0,
            notSale=true,
            canuse=false,    
        },
        shopmall_70={--四阶橙色通用装备宝箱(可堆叠)            价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=5000000,
            reward={Set_item={"4_5_5"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_3",
            notSale=true,
            canuse=true, 
        },
        shopmall_71={--四阶金色通用装备宝箱(可堆叠)            价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=5000000,
            reward={Set_item={"4_6_5"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_3",
            notSale=true,
            canuse=true, 
        },
        shopmall_72={--四阶红色通用装备宝箱(可堆叠)            价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=5000000,
            reward={Set_item={"4_7_5"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_3",
            notSale=true,
            canuse=true, 
        },
        shopmall_73={--五阶橙色通用装备宝箱(可堆叠)            价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=5000000,
            reward={Set_item={"5_5_5"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_3",
            notSale=true,
            canuse=true, 
        },
        shopmall_74={--五阶金色通用装备宝箱(可堆叠)            价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=5000000,
            reward={Set_item={"5_6_5"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_3",
            notSale=true,
            canuse=true, 
        },
        shopmall_75={--五阶红色通用装备宝箱(可堆叠)            价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=5000000,
            reward={Set_item={"5_7_5"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_3",
            notSale=true,
            canuse=true, 
        },
        shopmall_76={--六阶橙色特殊装备宝箱(可堆叠)            价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=5000000,
            reward={Set_item={"6_5_5"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_3",
            notSale=true,
            canuse=true, 
        },
        shopmall_77={--六阶金色特殊装备宝箱(可堆叠)            价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=5000000,
            reward={Set_item={"6_6_5"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_3",
            notSale=true,
            canuse=true, 
        },
        shopmall_78={--六阶红色特殊装备宝箱(可堆叠)            价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=5000000,
            reward={Set_item={"6_7_5"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_3",
            notSale=true,
            canuse=true, 
        },
        shopmall_79={--七阶橙色特殊装备宝箱(可堆叠)            价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=5000000,
            reward={Set_item={"7_5_5"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_3",
            notSale=true,
            canuse=true, 
        },
        shopmall_80={--七阶金色特殊装备宝箱(可堆叠)            价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=5000000,
            reward={Set_item={"7_6_5"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_3",
            notSale=true,
            canuse=true, 
        },
        shopmall_81={--七阶红色特殊装备宝箱(可堆叠)            价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=5000000,
            reward={Set_item={"7_7_5"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_3",
            notSale=true,
            canuse=true, 
        },
        shopmall_99={--八阶橙色随机装备宝箱(可堆叠)            价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=5000000,
            reward={Set_item={"8_5_5"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_3",
            notSale=true,
            canuse=true, 
        },
        shopmall_100={--八阶金色随机装备宝箱(可堆叠)            价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=5000000,
            reward={Set_item={"8_6_5"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_3",
            notSale=true,
            canuse=true, 
        },
        shopmall_101={--八阶红色随机装备宝箱(可堆叠)            价格：2000晶石      时间：单局消耗      作用：在商城背包里面随机给予一件 紫色或以上品质的存档装备
            price_jing=5000000,
            reward={Set_item={"8_7_5"}},
            stack=0,
            catalog1="chest",
            catalog2="equip_3",
            notSale=true,
            canuse=true, 
        },
        --[[shopmall_29={--装备强化石(可堆叠)		(暂无，不需要弄)      价格：100晶石      时间：单局消耗      作用：强化一件装备，提升属性      说明：作用的存档装备等级和品质越高，需要消耗的强化石越多
            price_jing=4800,
            reward={}
        }
        shopmall_30={--装备重铸石(可堆叠)		(暂无，不需要弄)      价格：100晶石      时间：单局消耗      作用：重新随机装备的词条种类      说明：作用的存档装备等级和品质越高，需要消耗的重铸石越多
            price_magic=4800,
            reward={}
        }
        shopmall_31={--装备洗练石(可堆叠)		(暂无，不需要弄)      价格：100晶石      时间：单局消耗      作用：重新计算装备的词条属性      说明：作用的存档装备等级和品质越高，需要消耗的洗练石越多  
            price_magic=4800,
            reward={}
        }
        shopmall_32={--装备升阶石(可堆叠)		(暂无，不需要弄)      价格：100晶石      时间：单局消耗      作用：将一件装备升级为更高阶的装备        说明：作用的存档装备等级和品质越高，需要消耗的升阶石越多  
            price_magic=4800,
            reward={}
        }]]
    }
    --由于要换成modifier显示，
    Shopmall.jjzc={
       -- [1]={Set_mana=20},--基础智慧术	 拥有智慧的头脑 魔法值+50
        [1]={GiveModifity={"modifiy_shopmall_jjzc_1"}},
       -- [2]={Attr_zhwsh=5},--基础召唤术	掌握召唤技巧	召唤物强度+10%  zhwsh
        [2]={GiveModifity={"modifiy_shopmall_jjzc_2"}},
        [3]={GiveModifity={"modifiy_shopmall_jjzc_3"}},--基础武器娴熟	攻击力+10%
        [4]={GiveModifity={"modifiy_shopmall_jjzc_4"}},--基础元素学  学习操控自然能量  技能伤害+5% 
        [5]={GiveModifity={"modifiy_shopmall_jjzc_5"}},--基础冥想术  提高元素吸收 魔法回复+2
        [6]={GiveModifity={"modifiy_shopmall_jjzc_6"}},--基础耐力	适当的锻炼提高生命力  最大生命值+5%
        [7]={GiveModifity={"modifiy_shopmall_jjzc_7"}},--基础力量	力量+10%
        [8]={GiveModifity={"modifiy_shopmall_jjzc_8"}},--基础敏捷	敏捷+10%
        [9]={GiveModifity={"modifiy_shopmall_jjzc_9"}},--基础智力	智力+10%
        [10]={GiveModifity={"modifiy_shopmall_jjzc_10"}},--基础灵活	攻击速度+10
        [11]={GiveModifity={"modifiy_shopmall_jjzc_11"}},--基础迅捷	移动速度+5
        [12]={GiveModifity={"modifiy_shopmall_jjzc_12"}},--基础法术抵抗	魔法抗性+3
        [13]={GiveModifity={"modifiy_shopmall_jjzc_13"}},--基础防御	防御+10
        [14]={GiveModifity={"modifiy_shopmall_jjzc_14"}},--基础坚韧	韧性+1 			rx
  --    [15]={Attr_wlbjgl=2},--基础暴击	暴击概率+2% 	wlbjgl
        [15]={GiveModifity={"modifiy_shopmall_jjzc_15"}},
  --    [16]={Attr_wlbjsh=10},--基础暴伤	暴击概率+10%    wlbjsh
        [16]={GiveModifity={"modifiy_shopmall_jjzc_16"}},
        [17]={GiveModifity={"modifiy_shopmall_jjzc_17"}},--基础治愈	生命值恢复+1%
  --      [18]={Set_ll=50},--基础力量锻炼	力量+50
        [18]={GiveModifity={"modifiy_shopmall_jjzc_18"}},
   --     [19]={Set_mj=50}, --基础敏捷锻炼	敏捷+50
        [19]={GiveModifity={"modifiy_shopmall_jjzc_19"}},
  --      [20]={Set_zl=50}, --基础智力锻炼	智力+50
        [20]={GiveModifity={"modifiy_shopmall_jjzc_20"}},
  --      [21]={Attr_shhm=1},--基础格挡	伤害豁免概率+1%  shhm
        [21]={GiveModifity={"modifiy_shopmall_jjzc_21"}},
 --     [22]={Attr_jqjc=5},--基础掠夺	金钱加成+5%  jqjc
        [22]={GiveModifity={"modifiy_shopmall_jjzc_22"}},
  --    [23]={Attr_jyjc=5},--基础恩泽	经验加成+5%  jyjc
        [23]={GiveModifity={"modifiy_shopmall_jjzc_23"}},
       }
       Shopmall.zjzc={
        -- [1]={Set_mana=40},--智慧术     拥有智慧的头脑 魔法值+100
        [1]={GiveModifity={"modifiy_shopmall_zjzc_1"}},
       -- [2]={Attr_zhwsh=10},--召唤术    掌握召唤技巧  召唤物强度+20%  zhwsh
        [2]={GiveModifity={"modifiy_shopmall_zjzc_2"}},
        [3]={GiveModifity={"modifiy_shopmall_zjzc_3"}},----中级武器娴熟	攻击力+20%
        [4]={GiveModifity={"modifiy_shopmall_zjzc_4"}},----中级元素学  学习操控自然能量  技能伤害+10%
        [5]={GiveModifity={"modifiy_shopmall_zjzc_5"}},----中级冥想术  提高元素吸收 魔法回复+4
        [6]={GiveModifity={"modifiy_shopmall_zjzc_6"}},----中级耐力	适当的锻炼提高生命力  最大生命值+10%
        [7]={GiveModifity={"modifiy_shopmall_zjzc_7"}},----中级力量	力量+20%
        [8]={GiveModifity={"modifiy_shopmall_zjzc_8"}},----中级敏捷	敏捷+20%
        [9]={GiveModifity={"modifiy_shopmall_zjzc_9"}},-- --中级智力	智力+20%
        [10]={GiveModifity={"modifiy_shopmall_zjzc_10"}},----中级灵活	攻击速度+20
        [11]={GiveModifity={"modifiy_shopmall_zjzc_11"}},-- --中级迅捷	移动速度+10
        [12]={GiveModifity={"modifiy_shopmall_zjzc_12"}},----中级法术抵抗	魔法抗性+6
        [13]={GiveModifity={"modifiy_shopmall_zjzc_13"}},----中级防御	防御+20
        [14]={GiveModifity={"modifiy_shopmall_zjzc_14"}},----中级坚韧	韧性+2 
        [15]={GiveModifity={"modifiy_shopmall_zjzc_15"}},--暴击概率+4%
        [16]={GiveModifity={"modifiy_shopmall_zjzc_16"}},--暴击伤害+20%
        [17]={GiveModifity={"modifiy_shopmall_zjzc_17"}},--生命回复+2%
        [18]={GiveModifity={"modifiy_shopmall_zjzc_18"}},--力量+100
        [19]={GiveModifity={"modifiy_shopmall_zjzc_19"}},--敏捷+100
        [20]={GiveModifity={"modifiy_shopmall_zjzc_20"}},--智力+100
        [21]={GiveModifity={"modifiy_shopmall_zjzc_21"}},--伤害豁免+2%
        [22]={GiveModifity={"modifiy_shopmall_zjzc_22"}},--金钱+20%
        [23]={GiveModifity={"modifiy_shopmall_zjzc_23"}},--经验加成+20%
       }
    Shopmall.gjzc={
        -- [1]={Set_mana=40},--智慧术     拥有智慧的头脑 魔法值+200
        [1]={GiveModifity={"modifiy_shopmall_gjzc_1"}},
       -- [2]={Attr_zhwsh=10},--召唤术    掌握召唤技巧  召唤物强度+40%  zhwsh
        [2]={GiveModifity={"modifiy_shopmall_gjzc_2"}},
        [3]={GiveModifity={"modifiy_shopmall_gjzc_3"}},----高级武器娴熟	攻击力+40%
        [4]={GiveModifity={"modifiy_shopmall_gjzc_4"}},----高级元素学  学习操控自然能量  技能伤害+20%
        [5]={GiveModifity={"modifiy_shopmall_gjzc_5"}},----高级冥想术  提高元素吸收 魔法回复+8
        [6]={GiveModifity={"modifiy_shopmall_gjzc_6"}},-- --高级耐力	适当的锻炼提高生命力  最大生命值+20%
        [7]={GiveModifity={"modifiy_shopmall_gjzc_7"}},----高级力量	力量+40%
        [8]={GiveModifity={"modifiy_shopmall_gjzc_8"}},----高级敏捷	敏捷+40%
        [9]={GiveModifity={"modifiy_shopmall_gjzc_9"}},--    --高级智力	智力+40%
        [10]={GiveModifity={"modifiy_shopmall_gjzc_10"}},----高级灵活	攻击速度+40
        [11]={GiveModifity={"modifiy_shopmall_gjzc_11"}},----高级迅捷	移动速度+20
        [12]={GiveModifity={"modifiy_shopmall_gjzc_12"}},----高级法术抵抗	魔法抗性+12
        [13]={GiveModifity={"modifiy_shopmall_gjzc_13"}},----高级防御	防御+40
        [14]={GiveModifity={"modifiy_shopmall_gjzc_14"}},--高级坚韧	韧性+3 	
        [15]={GiveModifity={"modifiy_shopmall_gjzc_15"}},  --暴击概率+6%
        [16]={GiveModifity={"modifiy_shopmall_gjzc_16"}},   --暴击伤害+40%
        [17]={GiveModifity={"modifiy_shopmall_gjzc_17"}}, --生命回复+4%
        [18]={GiveModifity={"modifiy_shopmall_gjzc_18"}}, --力量+200
        [19]={GiveModifity={"modifiy_shopmall_gjzc_19"}},--敏捷+200
        [20]={GiveModifity={"modifiy_shopmall_gjzc_20"}},--力量+200
        [21]={GiveModifity={"modifiy_shopmall_gjzc_21"}},--伤害豁免+4%
        [22]={GiveModifity={"modifiy_shopmall_gjzc_22"}},--金钱加成+20%
        [23]={GiveModifity={"modifiy_shopmall_gjzc_23"}},--经验加成+20%
    }

    Shopmall.cmzc={
        [1]={GiveModifity={"modifiy_shopmall_cmzc_1"}},
        [2]={GiveModifity={"modifiy_shopmall_cmzc_2"}},
        [3]={GiveModifity={"modifiy_shopmall_cmzc_3"}},----高级武器娴熟   攻击力+40%
        [4]={GiveModifity={"modifiy_shopmall_cmzc_4"}},----高级元素学  学习操控自然能量  技能伤害+20%
        [5]={GiveModifity={"modifiy_shopmall_cmzc_5"}},----高级冥想术  提高元素吸收 魔法回复+8
        [6]={GiveModifity={"modifiy_shopmall_cmzc_8"}},-- --高级耐力    适当的锻炼提高生命力  最大生命值+20%
        [7]={GiveModifity={"modifiy_shopmall_cmzc_9"}},
        [8]={GiveModifity={"modifiy_shopmall_cmzc_11"}},
        [9]={GiveModifity={"modifiy_shopmall_cmzc_13"}},
        [10]={GiveModifity={"modifiy_shopmall_cmzc_15"}},
        [11]={GiveModifity={"modifiy_shopmall_cmzc_16"}},
        [12]={GiveModifity={"modifiy_shopmall_cmzc_17"}},

    }
    Shopmall.tszc={
        [1]={GiveModifity={"modifiy_shopmall_tszc_1"}},
        [2]={GiveModifity={"modifiy_shopmall_tszc_2"}},
        [3]={GiveModifity={"modifiy_shopmall_tszc_3"}},
        [4]={GiveModifity={"modifiy_shopmall_tszc_4"}},
        [5]={GiveModifity={"modifiy_shopmall_tszc_5"}},
        [6]={GiveModifity={"modifiy_shopmall_tszc_6"}},
        [7]={GiveModifity={"modifiy_shopmall_tszc_9"}},
        [8]={GiveModifity={"modifiy_shopmall_tszc_10"}},


    }
    Shopmall.battlepass={
        exp = { --经验信息
            now = 12, --当前等级拥有的经验值 	##从一个总经验值，改成两个属性now和max
            max = 123456,--当前等级升级需要的经验值 	##从一个总经验值，改成两个属性now和max
            level = 1 ---对应的等级，由于考虑到dota端也可能需要等级，所以统一放到dota端计算等级，客户端做显示，保证前后端一致
        },
        quest = {--任务信息
            day = {--每日任务，数组结构的表
              
            },
            weekly = {--每周任务
              
            }
        },
        bonus = {--本赛季各个等级的奖励信息，奖励信息是一个数组类型的表，key代表等级
            [1] = {--等级
                [1] = { --普通版奖励
                    name = "BPreward_base_1", --奖励名称，奖励图片和描述要用到
                    state = 0,--奖励领取状态：数字0表示不需要领取，到等级了自动激活（比如属性类），数字1表示需要领取但是尚未领取，字符串（形如"2021-12-12 12:12:12"）代表领取时间
                    noStore = true, --这个奖励不是商城道具奖励？设置为true代表不是商城道具奖励，不需要往商城道具记录里添加
                	count = 1
                },
                [2] = { --进阶版奖励
                    name = "shopmall_39",
                    state = 1,
                    count = 1
                }
            },
            [2] = {
                [1] = { --普通版奖励
                    name = "BPreward_base_2", --奖励名称，奖励图片和描述要用到
                    state = 0,
                    noStore = true,
                    count = 1
                },
                [2] = { --进阶版奖励
                    name = "shopmall_38",
                    state = 1,
                    count = 1 
                }
            },
            [3] = {
                [1] = { --普通版奖励
                    name = "BPreward_base_3", --奖励名称，奖励图片和描述要用到
                    state = 0,
                    noStore = true,
                    count = 1
                },
                [2] = { --进阶版奖励
                    name = "shopmall_40",
                    state = 1,
                    count = 1
                }
            },
            [4] = {
                [1] = { --普通版奖励
                    name = "BPreward_base_4", --奖励名称，奖励图片和描述要用到
                    state = 0,
                    noStore = true ,
                    count = 1
                },
                [2] = { --进阶版奖励
                    name = "BPreward_plus_4",
                    state = 0,
                    noStore = true ,
                    count = 1
                }
            },
            [5] = {
                [1] = { --普通版奖励
                    name = "BPreward_base_5", --奖励名称，奖励图片和描述要用到
                    state = 0,
                    noStore = true,
                    count = 1
               },
                [2] = { --进阶版奖励
                    name = "BPreward_plus_5",
                    state = 0,
                    noStore = true ,
                    count = 1
                }
            },
            [6] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 10
                },
                [2] = { --进阶版奖励
                    name = "shopmall_47",
                    state = 1,
                    count = 10
                }
            },
            [7] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 10
                },
                [2] = { --进阶版奖励
                    name = "BPreward_plus_7",
                    state = 0,
                    noStore = true,
                    count = 1
                }
            },
            [8] = {
                [1] = { --普通版奖励
                    name = "BPreward_base_8", --奖励名称，奖励图片和描述要用到
                    state = 0,
                    noStore = true ,
                    count = 1
                },
                [2] = { --进阶版奖励
                    name = "BPreward_plus_8",
                    state = 0,
                    noStore = true,
                    count = 1
                }
            },
            [9] = {
                [1] = { --普通版奖励
                    name = "BPreward_base_9", --奖励名称，奖励图片和描述要用到
                    state = 0,
                    noStore = true,
                    count = 1
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 15
                }
            },
            [10] = {
                [1] = { --普通版奖励
                    name = "BPreward_base_10", --奖励名称，奖励图片和描述要用到
                    state = 0,
                    noStore = true,
                    count = 1
                },
                [2] = { --进阶版奖励
                    name = "jing_plus_10",
                    state = 1,
                    count = 1
                }
            },
            [11] = {
                [1] = { --普通版奖励
                    name = "BPreward_base_11", --奖励名称，奖励图片和描述要用到
                    state = 0,
                    noStore = true,
                    count = 1
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 15
                }
            },
            [12] = {
                [1] = { --普通版奖励
                    name = "BPreward_base_12", --奖励名称，奖励图片和描述要用到
                    state = 0,
                    noStore = true,
                    count = 1
                },
                [2] = { --进阶版奖励
                    name = "shopmall_47",
                    state = 1,
                    count = 20
                }
            },
            [13] = {
                [1] = { --普通版奖励
                    name = "BPreward_base_13", --奖励名称，奖励图片和描述要用到
                    state = 0,
                    noStore = true,
                    count = 1
                },
                [2] = { --进阶版奖励
                    name = "BPreward_plus_13",
                    state = 0,
                    noStore = true,
                    count = 1
                }
            },
            [14] = {
                [1] = { --普通版奖励
                    name = "BPreward_base_14", --奖励名称，奖励图片和描述要用到
                    state = 0,
                    noStore = true,
                    count = 1
                },
                [2] = { --进阶版奖励
                    name = "jing_plus_14",
                    state = 1,
                    count = 1
                }
            },
            [15] = {
                [1] = { --普通版奖励
                    name = "BPreward_base_15", --奖励名称，奖励图片和描述要用到
                    state = 0,
                    noStore = true,
                    count = 1
                },
                [2] = { --进阶版奖励
                    name = "shopmall_cw_1_202",
                    state = 1,
                    count = 1
                }
            },
            [16] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 10
                },
                [2] = { --进阶版奖励
                    name = "BPreward_plus_16",
                    state = 0,
                    noStore = true,
                    count = 1
                }
            },
            [17] = {
                [1] = { --普通版奖励
                    name = "BPreward_base_17", --奖励名称，奖励图片和描述要用到
                    state = 0,
                    noStore = true,
                    count = 1
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 15
                }
            },
            [18] = {
                [1] = { --普通版奖励
                    name = "BPreward_base_18", --奖励名称，奖励图片和描述要用到
                    state = 0,
                    noStore = true,
                    count = 1
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 15
                }
            },
            [19] = {
                [1] = { --普通版奖励
                    name = "BPreward_base_19", --奖励名称，奖励图片和描述要用到
                    state = 0,
                    noStore = true,
                    count = 1
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 15
                }
            },
            [20] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 20
                },
                [2] = { --进阶版奖励
                    name = "BPreward_plus_20",
                    state = 0,
                    noStore = true,
                    count = 1
                }
            },
            [21] = {
                [1] = { --普通版奖励
                    name = "BPreward_base_21", --奖励名称，奖励图片和描述要用到
                    state = 0,
                    noStore = true,
                    count = 1
                },
                [2] = { --进阶版奖励
                    name = "shopmall_48",
                    state = 1,
                    count = 10
                }
            },
            [22] = {
                [1] = { --普通版奖励
                    name = "BPreward_base_22", --奖励名称，奖励图片和描述要用到
                    state = 0,
                    noStore = true,
                    count = 1
                },
                [2] = { --进阶版奖励
                    name = "BPreward_plus_22",
                    state = 0,
                    noStore = true,
                    count = 1
                }
            },
            [23] = {
                [1] = { --普通版奖励
                    name = "BPreward_base_23", --奖励名称，奖励图片和描述要用到
                    state = 0,
                    noStore = true,
                    count = 1
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 20
                }
            },
            [24] = {
                [1] = { --普通版奖励
                    name = "BPreward_base_24", --奖励名称，奖励图片和描述要用到
                    state = 0,
                    noStore = true,
                    count = 1
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 20
                }
            },
            [25] = {
                [1] = { --普通版奖励
                    name = "shopmall_gh_1_102", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 1
                          },
                [2] = { --进阶版奖励
                    name = "shopmall_gh_1_202",
                    state = 1,
                    count = 1           
                }
            },
            [26] = {
                [1] = { --普通版奖励
                    name = "shopmall_48", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 10
                },
                [2] = { --进阶版奖励
                    name = "shopmall_sstone_5",
                    state = 1,
                    count = 300
                }
            },
            [27] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 10
                },
                [2] = { --进阶版奖励
                    name = "shopmall_sstone_6",
                    state = 1,
                    count = 200
                }
            },
            [28] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 15
                },
                [2] = { --进阶版奖励
                    name = "shopmall_sstone_7",
                    state = 1,
                    count = 150
                }
            },
            [29] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 20
                },
                [2] = { --进阶版奖励
                    name = "shopmall_sstone_8",
                    state = 1,
                    count = 100
                }
            },
            [30] = {
                [1] = { --普通版奖励
                    name = "BPreward_base_30", --奖励名称，奖励图片和描述要用到
                    state = 0,
                    noStore = true,
                    count = 1
                },
                [2] = { --进阶版奖励
                    name = "BPreward_plus_30",
                    state = 0,
                    noStore = true,
                    count = 1
                }
            },
            [31] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 2
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 2
                }
            },
            [32] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 2
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 2
                }
            },
            [33] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 2
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 2
                }
            },
            [34] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 2
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 2
                }
            },
            [35] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 10
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 10
                }
            },
            [36] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 2
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 2
                }
            },
            [37] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 2
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 2
                }
            },
            [38] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 2
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 2
                }
            },
            [39] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 2
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 2
                }
            },
            [40] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 10
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 10
                }
            },
            [41] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 2
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 2
                }
            },
            [42] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 2
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 2
                }
            },
            [43] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 2
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 2
                }
            },
            [44] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 2
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 2
                }
            },
            [45] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 10
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 10
                }
            },
            [46] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 2
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 2
                }
            },
            [47] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 2
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 2
                }
            },
            [48] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 2
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 2
                }
            },
            [49] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 2
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 2
                }
            },
            [50] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 10
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 10
                }
            },
            [51] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 2
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 2
                }
            },
            [52] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 2
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 2
                }
            },
            [53] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 2
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 2
                }
            },
            [54] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 2
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 2
                }
            },
            [55] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 10
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 10
                }
            },
            [56] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 2
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 2
                }
            },
            [57] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 2
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 2
                }
            },
            [58] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 2
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 2
                }
            },
            [59] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 2
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 2
                }
            },
            [60] = {
                [1] = { --普通版奖励
                    name = "shopmall_68", --奖励名称，奖励图片和描述要用到
                    state = 1,
                    count = 10
                },
                [2] = { --进阶版奖励
                    name = "shopmall_68",
                    state = 1,
                    count = 10
                }
            },

        
        }
    }
    Shopmall.BPreward_1={
        [1]={Set_refresh=1},--1.英雄刷新
        [2]={Attr_bfbtsll=5},--2.百分比提升5%的力量						 
        [3]={Attr_bfbtsmj=5},--3.百分比提升5%的敏捷						
        [4]={Attr_bfbtszl=5},--4.百分比提升5%的智力
        [5]={Attr_bfbtsqsx=5},--5.百分比提升5%的全属性
        [6]={Giveshopmall=10},--6.征战钥匙+10
        [7]={Giveshopmall=10},--7.征战钥匙+10				
        [8]={Attr_sds=100},--8.杀敌数+100 					
        [9]={Attr_msmjsds=5},--9.每10S杀敌数+5
        [10]={Attr_wlct=2},--10.物理穿透+2 	 
        [11]={Attr_mfct=2,},--11.魔法穿透+2 		
        [12]={GiveModifity={"modifiy_shopmall_bp_12"}},--12.技能伤害+5% 		   		  
        [13]={Attr_wlbjsh=20,Attr_mfbjsh=20},--13.暴击伤害+20% 			 	
        [14]={Attr_wlbjgl=2,Attr_mfbjgl=2},--14.暴击概率+2% 					
        [15]={Attr_grjndj=1},--15.个人技能等级+1
        [16]={Giveshopmall=10},--16.征战钥匙+10
        [17]={Set_refresh=1},--17.选英雄界面刷新英雄次数+1 永久（如果有了则 晶石+2000，不会和月卡重复，且永久生效，下一个月也还是会出现这个奖励）
        [18]={Attr_fjsh=2},--18.附加伤害+2% 					
        [19]={Attr_zzsh=2},--19.最终伤害+2% 					 
        [20]={Giveshopmall=20},--20.征战钥匙+20
        [21]={Attr_grjndj=1,},--21.个人技能等级+1 				
        [22]={Attr_tmz=10},--22.天命值+10
        [23]={Attr_jqjc=5},--23.金钱加成+5% 					 
        [24]={Attr_jyjc=5},--24.经验加成+5% 					
        [25]={Giveshopmall=1},--25.第二赛季基础光环
        [26]={Giveshopmall=10},--26.超魔专长--消耗+10 	
        [27]={Giveshopmall=10},--27.征战钥匙+10
        [28]={Giveshopmall=15},--28.征战钥匙+15
        [29]={Giveshopmall=20},--29.征战钥匙+20
        [30]={Attr_qhsdlbs=0.1}, --30.掉落强化石+10%
        [31]={Giveshopmall=2},
        [32]={Giveshopmall=2},
        [33]={Giveshopmall=2},
        [34]={Giveshopmall=2},
        [35]={Giveshopmall=10},
        [36]={Giveshopmall=2},
        [37]={Giveshopmall=2},
        [38]={Giveshopmall=2},
        [39]={Giveshopmall=2},
        [40]={Giveshopmall=10},
        [41]={Giveshopmall=2},
        [42]={Giveshopmall=2},
        [43]={Giveshopmall=2},
        [44]={Giveshopmall=2},
        [45]={Giveshopmall=10},
        [46]={Giveshopmall=2},
        [47]={Giveshopmall=2},
        [48]={Giveshopmall=2},
        [49]={Giveshopmall=2},
        [50]={Giveshopmall=10},
        [51]={Giveshopmall=2},
        [52]={Giveshopmall=2},
        [53]={Giveshopmall=2},
        [54]={Giveshopmall=2},
        [55]={Giveshopmall=10},
        [56]={Giveshopmall=2},
        [57]={Giveshopmall=2},
        [58]={Giveshopmall=2},
        [59]={Giveshopmall=2},
        [60]={Giveshopmall=10},
    }
    Shopmall.BPreward_2={
        [1]={Giveshopmall=1},--三阶橙色首饰装备宝箱 shopmall_39
        [2]={Giveshopmall=1},--2.    三阶橙色防具装备宝箱
        [3]={Giveshopmall=1},--三阶橙色特殊装备宝箱shopmall_40
        [4]={Attr_xyz=10},--幸运值+10
        [5]={Set_jjzc=1},--5.初始额外获得一个初级专长
        [6]={Giveshopmall=10},--6.超魔专长消耗数量+10
        [7]={Set_zjzc=1},--7.初始额外使用一个中级专长
        [8]={Attr_treasure=1},--8.宝物槽位数量+1
        [9]={Giveshopmall=15},--9.征战钥匙+15
        [10]={Giveshopmall=50000},--10.晶石+50000
        [11]={Giveshopmall=15},--11.征战钥匙+15
        [12]={Giveshopmall=20},--12.超魔专长消耗数量+20
        [13]={Attr_tmz=10},--天命值+10
        [14]={Giveshopmall=50000},--14.晶石+50000
        [15]={Giveshopmall=1},--15.第一赛季进阶宠物奖励
        [16]={Set_gjzc=1},--16.初始额外使用一个高级专长
        [17]={Giveshopmall=15},--17.征战钥匙+15
        [18]={Giveshopmall=15},--18.征战钥匙+15
        [19]={Giveshopmall=15},--19.征战钥匙+15
        [20]={Set_cmzc=1},--20.初始额外使用一个超魔专长
        [21]={Giveshopmall=10},-- 特殊专长消耗数量+10
        [22]={Attr_tmz3=10},--        23.高品爆率+10
        [23]={Giveshopmall=20},--        23.征战钥匙+20
        [24]={Giveshopmall=20},--24.征战钥匙+20
        [25]={Giveshopmall=1},--光环
        [26]={Giveshopmall=300},--26..5级强化石+300
        [27]={Giveshopmall=200},--29.6级强化石+200
        [28]={Giveshopmall=150},--28.7级强化石+150
        [29]={Giveshopmall=100},--29.8级强化石+100
        [30]={Attr_qhsdlbs=0.1},--30.结算时掉落强化石+10%
        [31]={Giveshopmall=2},-----
        [32]={Giveshopmall=2},
        [33]={Giveshopmall=2},
        [34]={Giveshopmall=2},
        [35]={Giveshopmall=10},
        [36]={Giveshopmall=2},
        [37]={Giveshopmall=2},
        [38]={Giveshopmall=2},
        [39]={Giveshopmall=2},
        [40]={Giveshopmall=10},
        [41]={Giveshopmall=2},
        [42]={Giveshopmall=2},
        [43]={Giveshopmall=2},
        [44]={Giveshopmall=2},
        [45]={Giveshopmall=10},
        [46]={Giveshopmall=2},
        [47]={Giveshopmall=2},
        [48]={Giveshopmall=2},
        [49]={Giveshopmall=2},
        [50]={Giveshopmall=10},
        [51]={Giveshopmall=2},
        [52]={Giveshopmall=2},
        [53]={Giveshopmall=2},
        [54]={Giveshopmall=2},
        [55]={Giveshopmall=10},
        [56]={Giveshopmall=2},
        [57]={Giveshopmall=2},
        [58]={Giveshopmall=2},
        [59]={Giveshopmall=2},
        [60]={Giveshopmall=10},
    }
    --Shopmall.quest_day_exp=30
    --Shopmall.quest_week_exp=100
    Shopmall.quest_day={
            [1]={name="hero_pass_1",
                times=2,
                exp=50
           },--使用力量英雄通关任意难度
            [2]={name="hero_pass_2",
                times=2,
                exp=50
           },--使用敏捷英雄通关任意难度
            [3]={name="hero_pass_3",
                times=2,
                exp=50
           },--使用智力英雄通关任意难度
            [4]={name="hero_killboss_1",
                times=3,
                exp=50
           },--击杀BOSS伐木机
            [5]={name="hero_killboss_2",
                times=3,
                exp=50
           },--击杀BOSS卡尔
            [6]={name="hero_killboss_3",
                times=3,
                exp=50
           },--击杀BOSS死亡骑士
            [7]={name="hero_killboss_4",
                times=3,
                exp=50
           },--击杀BOSS山丘巨人
            [8]={name="hero_killboss_5",
                times=3,
                exp=50
           },--击杀BOSS凤凰
            [9]={name="hero_killboss_6",
                times=3,
                exp=50
           },--击杀BOSS幻影刺客
            [10]={name="hero_killunit_1",
                times=5000,
                exp=60
           },--击杀5000个小怪
            [11]={name="hero_getboss_1",
                times=1000,
                exp=70
           },--获得500点BOSS点数
          --  [1]={name="difficulty_1",
          --       times=1,
          --       exp=50
         --  },--通关N1
        }
        Shopmall.quest_week={
            
            [1]={name="hero_killunit_1",
                times=50000,
                exp=300
           },--累积击杀小怪30000只 
           [2]={name="hero_getboss_1",
                times=10000,
                exp=400
           },--获得500点BOSS点数
           [3]={name="hero_killboss_1",
                times=20,
                exp=300
           },--击杀BOSS伐木机
            [4]={name="hero_killboss_2",
                times=20,
                exp=300
           },--击杀BOSS卡尔
            [5]={name="hero_killboss_3",
                times=20,
                exp=300
           },--击杀BOSS死亡骑士
            [6]={name="hero_killboss_4",
                times=20,
                exp=300
           },--击杀BOSS山丘巨人
            [7]={name="hero_killboss_5",
                times=20,
                exp=300
           },--击杀BOSS凤凰
            [8]={name="hero_killboss_6",
                times=20,
                exp=300
           },--击杀BOSS幻影刺客
           [9]={name="hero_pass_1",
                times=8,
                exp=300
           },--使用力量英雄通关任意难度
            [10]={name="hero_pass_2",
                times=8,
                exp=300
           },--使用敏捷英雄通关任意难度
            [11]={name="hero_pass_3",
                times=8,
                exp=300
            },
         --   [1]={name="difficulty_5_2",
          --      times=1,
         --       exp=250
         --  },--通关N5狂暴模式
        -- [3]={name="difficulty_10",
          --      times=3,
         --       exp=300
         --  },--累积通关N5 3次
        }

end

-- 初始化
function Shopmall:__call( playerid )
--	local data=Sachievement:DeepCopy(Shopmall.list)
--    for k,v in pairs(data) do
--        local temp={}
--        temp.price_magic=""--（仙石价格，可为空）,
--        temp.price_jing=""
--        temp.catalog1=""
--        temp.catalog2=""
--        if v["price_magic"] then
--            temp.price_magic=v["price_magic"]
--        end
--        if v["price_jing"] then
--            temp.price_jing=v["price_jing"]
--        end
--        if v["catalog1"] then
--            temp.catalog1=v["catalog1"]
--        end
--        if v["catalog2"] then
--            temp.catalog2=v["catalog2"]
--        end
--        CustomNetTables:SetTableValue("config",k,temp)
--		v.state=false
--	end
   
end
--商品是不是唯一的，true唯一，false非唯一
function Shopmall:IsUnique( itemname )
    if Shopmall.list[itemname] and Shopmall.list[itemname]['stack']==nil then
        return true
    end
    return false
end

function Shopmall:SetPlayerdata( playerid,data )
    --PrintTable(data)
    self:SetStone(playerid,"init",1,data.currency.ms)
    self:SetStone(playerid,"init",2,data.currency.jing)
    local datatable={}
    for k,v in pairs(data["item"]) do 
        datatable[k]={}
        datatable[k]["invalid_time"]=v["invalid_time"]
        datatable[k]["stack"]=v["stack"]
        if k=="shopmall_1" then  --添加通行证

        end
    end
    self.Playermall[playerid]=datatable
    self.playerzc[playerid]={}
    --PrintTable(self.Playermall[playerid])
	CustomNetTables:SetTableValue("shopmall", "player_data_"..playerid,self.Playermall[playerid])
end
function Shopmall:SetHerodata(unit)
    local playerdata=self:GetMallState(unit:GetPlayerOwnerID())
    Shopmall.herotype[unit:GetPlayerOwnerID()]=unit:GetPrimaryAttribute()
    local cwlist={}--宠物表用来随机宠物
    local chlist={}--称号表用来随机称号
    local ghlist={}--光环表用来随机光环
    
    for k,v in pairs(playerdata) do
        if Shopmall:IsUnique( k ) then  --不是消耗品
            self:SetReWard( unit,Shopmall.list[k]['reward'])
        end
        if k=="plus" then
            self:SetReWard( unit,Shopmall.list["shopmall_46"]['reward'])
        end
        local NameArray=string.split(k, "_")
        if NameArray[2]=="cw" then
            table.insert(cwlist,k)
        end
        if NameArray[2]=="ch" then
            table.insert(chlist,k)
        end
        if NameArray[2]=="gh" then
            table.insert(ghlist,k)
        end
    end
    unit:SetContextThink(DoUniqueString("getcustomdata"), function()  --添加宠物
        if SrvPlayerCustom.HasInited()==true then
            local temp=SrvPlayerCustom.GetData(unit:GetPlayerOwnerID(),"shopmallcw")
            local temp_ch=SrvPlayerCustom.GetData(unit:GetPlayerOwnerID(),"shopmallch")
            local temp_gh=SrvPlayerCustom.GetData(unit:GetPlayerOwnerID(),"shopmallgh")
            if temp then
                if playerdata["shopmall_"..temp]~=nil then
                    self:SetCourier(unit,temp)    
                end
            else
                if TableLen(cwlist) ~= 0 then
                    local unitname=Shopmall.list[cwlist[RandomInt(1, #cwlist)]]['reward']["Set_courier"]
                    SrvPlayerCustom.SetData(unit:GetPlayerOwnerID(),"shopmallcw",unitname)
                    self:SetCourier(unit,unitname)    
                end
            end
            if temp_ch then
                if playerdata["shopmall_"..temp_ch]~=nil then
                    self:SetCH(unit,temp_ch)
                end
            else
                if TableLen(chlist) ~= 0 then
                    local chname=Shopmall.list[chlist[RandomInt(1, #chlist)]]['reward']["Set_ch"]
                    SrvPlayerCustom.SetData(unit:GetPlayerOwnerID(),"shopmallch",chname)
                    self:SetCH(unit,chname)
                end
                
            end
            if temp_gh then
                if playerdata["shopmall_"..temp_gh]~=nil then
                    self:SetGH(unit,temp_gh)
                end
            else
                if TableLen(ghlist) ~= 0 then
                    local ghname=Shopmall.list[ghlist[RandomInt(1, #ghlist)]]['reward']["Set_gh"]
                    SrvPlayerCustom.SetData(unit:GetPlayerOwnerID(),"shopmallgh",ghname)
                    self:SetGH(unit,ghname)
                end
                
            end
            return nil
        end
        return 1
    end, 0)

        
    
    local temp=self:GetPlayerBP(unit:GetPlayerOwnerID())  --把通行证奖励发放了
    ---给通行证普通奖励
    for i=1,temp.exp.level do
        self:SetReWard( unit,self.BPreward_1[i])
        if  Shopmall:HasItem(unit:GetPlayerOwnerID(),"shopmall_1")==true then   --有无通行证判断
           self:SetReWard( unit,self.BPreward_2[i])
        end
    end
end
--[[
function Shopmall:GetSomeData(dataname,list,callback)
    
end]]
function Shopmall:SetCourier(unit,couriername)
    if unit.shopmallcourier then
        unit.shopmallcourier:ForceKill(false)
        local name =unit.shopmallcourier:GetUnitName()
        if name then
            unit:RemoveModifierByName("modifier_"..name)
        end
    end
    local vec=unit:GetOrigin()+RandomVector(200)
    local courier=CreateUnitByName(couriername, vec, true, nil, nil, unit:GetTeamNumber())
    unit:AddNewModifier(unit, nil, "modifier_"..couriername, {} )
    unit.shopmallcourier=courier
    FindClearSpaceForUnit(courier,vec,true)
    PetAI.Init(courier,unit)
end
function Shopmall:SetGH(unit,ghname)
    if unit.gh then                 
        unit:RemoveModifierByName("modifier_"..unit.gh)
    end
    unit:AddNewModifier(unit, nil, "modifier_"..ghname, {} )
    unit.gh=ghname
end

function Shopmall:SetCH(unit,chname)
    if unit.ch then                 
        unit:RemoveModifierByName("modifier_"..unit.ch)
    end
    unit:AddNewModifier(unit, nil, "modifier_"..chname, {} )
    unit.ch=chname
end

function Shopmall:Getherotype( playerid )
    return Shopmall.herotype[playerid]
end

function Shopmall:UpdatePlayerdata( playerid,itemname,num,time )
    local playerdata=self:GetMallState(playerid)
    if playerdata[itemname]==nil then
        playerdata[itemname]={}
    end
    if num==nil then
        playerdata[itemname]["invalid_time"]=time
    else
        if num==0 then
            playerdata[itemname]=nil
        else
            playerdata[itemname]["stack"]=num
            playerdata[itemname]["invalid_time"]=time
        end
    end
    
    
	CustomNetTables:SetTableValue("shopmall", "player_data_"..playerid,playerdata)
end

function Shopmall:SetStone(playerid,eventname,ftype,number)
    local data=CustomNetTables:GetTableValue("PlayerInfo", "store_currency_"..playerid)
    if data==nil then
        data={}
    end
    if ftype==1 then
        data['magic']=number
    end
    if ftype==2 then
        data['jing']=number
    end
    data.tokens={eventName=eventname}
    CustomNetTables:SetTableValue("PlayerInfo", "store_currency_"..playerid,data)
end
function Shopmall:GetMallState( playerid)
	return self.Playermall[playerid] or {}
end
function Shopmall:SendFWmessage( unit,shopmallitemname,tempname)
    local maxtimes=Shopmall.list[shopmallitemname]['maxtimes']
    local lasttime=maxtimes
    local usetimes=PlayerUtil.getAttrByPlayer(unit:GetPlayerID(),shopmallitemname.."_usetimes")
    if usetimes then
        lasttime=maxtimes-usetimes
    end
    local temp={}
    temp[shopmallitemname]=lasttime
    SendToClient(unit:GetPlayerID(),"tzj_rune_added", {rune=tempname,max=temp}) --添加专长
end
function Shopmall:SetReWard( unit,reward,shopmallitemname)---给成就奖励和地图等级
    if type(reward) ~= "table" then
		return
    end
    --local player = PlayerResource:GetPlayer(playerid)
    --if player == nil then return end
    --local unit = player:GetAssignedHero()
    if unit==nil then
        return
    end
	for k,v in pairs(reward) do
		local NameArray=string.split(k, "_")
		if NameArray[1]=="GiveModifity" then --添加modfity
			for kk,vv in pairs(v) do
				unit:AddNewModifier(unit, nil,vv, {})
			end
		end
		if NameArray[1]=="Giveitem" then --添加modfity
			for kk,vv in pairs(v) do
				local addItem = CreateItem(vv, unit, unit)
				unit:AddItem(addItem)
			end
		end
		if NameArray[1]=="Givegold" then --给钱
			PlagueLand:ModifyCustomGold(unit:GetPlayerID(), v)
		end
		if NameArray[1]=="Attr" then --给属性
			if NameArray[2]=="sjPm" then --给主属性Attr_sjjll=2,Attr_sjjmj=2,Attr_sjjzl 三选一
				local temp={}
				if unit:GetPrimaryAttribute()==0 then
					temp["sjjll"] = v
				end
				if unit:GetPrimaryAttribute()==1 then
					temp["sjjmj"] = v
				end
				if unit:GetPrimaryAttribute()==2 then
					temp["sjjzl"] = v
				end
				AttributesSet(unit,temp)
			else
				local temp={}
				temp[NameArray[2]] = v
				AttributesSet(unit,temp)
			end
		end
		if NameArray[1]=="Set" then --直接设置
			if NameArray[2]=="AllPRO" then --直接给全属性
				unit:ModifyStrength(v)
				unit:ModifyIntellect(v)
				unit:ModifyAgility(v)
			elseif  NameArray[2]=="ll" then --直接给力量
                unit:ModifyStrength(v)
            elseif  NameArray[2]=="mj" then --直接给力量
                unit:ModifyAgility(v)
            elseif  NameArray[2]=="zl" then --直接给力量
                unit:ModifyIntellect(v)
            elseif  NameArray[2]=="mana" then --直接给力量
                unit:SetMaxMana(unit:GetMaxMana()+v)
            elseif  NameArray[2]=="jjzc" then --基础专长
             --     local resulttable=RandomNoRepeat(Sachievement:DeepCopy(Shopmall[NameArray[2]]),v) --只有当此的不会重复，如果还用了就会重复
                 -- for kk,vv in pairs(resulttable) do
               --     self:SetReWard(unit,vv)
               --   end
                    local tszc = {}
                    for kk,vv in pairs(Shopmall[NameArray[2]]) do
                        if not unit:HasModifier(vv.GiveModifity[1]) then
                            table.insert(tszc,vv.GiveModifity[1])
                        end
                    end
                    
                    for i=1,v do
                        local r = RandomInt(1,#tszc)
                        unit:AddNewModifier(unit, nil, tszc[r], {} )
                        local tempname=string.sub(tszc[r],9,string.len(tszc[r]))
                        table.insert(self.playerzc[unit:GetPlayerID()],tempname)
                        if shopmallitemname then
                            self:SendFWmessage( unit,shopmallitemname,tempname)
                        end
                        table.remove(tszc,r)
                    end             
            elseif  NameArray[2]=="zjzc" then --中级专长
                    local tszc = {}
                    for kk,vv in pairs(Shopmall[NameArray[2]]) do
                        if not unit:HasModifier(vv.GiveModifity[1]) then
                            table.insert(tszc,vv.GiveModifity[1])
                        end
                    end
                    for i=1,v do
                        local r = RandomInt(1,#tszc)
                        unit:AddNewModifier(unit, nil, tszc[r], {} )
                        local tempname=string.sub(tszc[r],9,string.len(tszc[r]))
                        table.insert(self.playerzc[unit:GetPlayerID()],tempname)
                        if shopmallitemname then
                            self:SendFWmessage( unit,shopmallitemname,tempname)
                        end
                        table.remove(tszc,r)
                    end             
            elseif  NameArray[2]=="gjzc" then --高级专长
                    local tszc = {}
                    for kk,vv in pairs(Shopmall[NameArray[2]]) do
                        if not unit:HasModifier(vv.GiveModifity[1]) then
                            table.insert(tszc,vv.GiveModifity[1])
                        end
                    end
                    for i=1,v do
                        local r = RandomInt(1,#tszc)
                        unit:AddNewModifier(unit, nil, tszc[r], {} )
                        local tempname=string.sub(tszc[r],9,string.len(tszc[r]))
                        table.insert(self.playerzc[unit:GetPlayerID()],tempname)
                        if shopmallitemname then
                            self:SendFWmessage( unit,shopmallitemname,tempname)
                        end
                        table.remove(tszc,r)
                    end             
            elseif  NameArray[2]=="cmzc" then --超魔专长
                    local tszc = {}
                    for kk,vv in pairs(Shopmall[NameArray[2]]) do
                        if not unit:HasModifier(vv.GiveModifity[1]) then
                            table.insert(tszc,vv.GiveModifity[1])
                        end
                    end
                    for i=1,v do
                        local r = RandomInt(1,#tszc)
                        unit:AddNewModifier(unit, nil, tszc[r], {} )
                        local tempname=string.sub(tszc[r],9,string.len(tszc[r]))
                        table.insert(self.playerzc[unit:GetPlayerID()],tempname)
                        if shopmallitemname then
                            self:SendFWmessage( unit,shopmallitemname,tempname)
                        end
                        table.remove(tszc,r)
                    end             
            elseif  NameArray[2]=="tszc" then --特殊专长
                    local tszc = {}
                    for kk,vv in pairs(Shopmall[NameArray[2]]) do
                        if not unit:HasModifier(vv.GiveModifity[1]) then
                            table.insert(tszc,vv.GiveModifity[1])
                        end
                    end
                    for i=1,v do
                        local r = RandomInt(1,#tszc)
                        unit:AddNewModifier(unit, nil, tszc[r], {} )
                        local tempname=string.sub(tszc[r],9,string.len(tszc[r]))
                        table.insert(self.playerzc[unit:GetPlayerID()],tempname)
                        if shopmallitemname then
                            self:SendFWmessage( unit,shopmallitemname,tempname)
                        end
                        table.remove(tszc,r)
                    end             
            elseif  NameArray[2]=="Pm" then --直接给主属性
				if unit:GetPrimaryAttribute()==0 then
					unit:ModifyStrength(v)
				end
				if unit:GetPrimaryAttribute()==1 then
					unit:ModifyAgility(v)
				end
				if unit:GetPrimaryAttribute()==2 then
					unit:ModifyIntellect(v)
				end
            elseif  NameArray[2]=="item" then --宝箱
               for kk,vv in pairs(v) do
                    local itemarray=string.split(vv, "_")
                    Netbackpack:OpenNetbox(unit:GetPlayerID(),itemarray[1],itemarray[2],itemarray[3])
                end
			elseif  NameArray[2]=="yaoji" then --药剂
				 for kk,vv in pairs(v) do
                    local itemarray=string.split(vv, "_")
                    UseDrug(unit:GetPlayerID(),itemarray[1],itemarray[2])
                end
            elseif  NameArray[2]=="courier" then --宠物
                SrvPlayerCustom.SetData(unit:GetPlayerID(),"shopmallcw",v)
                self:SetCourier(unit,v)
            elseif  NameArray[2]=="gh" then --光环
                SrvPlayerCustom.SetData(unit:GetPlayerID(),"shopmallgh",v)
                self:SetGH(unit,v)
            elseif  NameArray[2]=="ch" then --称号
                SrvPlayerCustom.SetData(unit:GetPlayerID(),"shopmallch",v)
                self:SetCH(unit,v)
            end
            
		end
	end
end

Shopmall.ConsumeItemCallBack=function( state,...)
    print("ConsumeItemCallBack")
    print(...)
end
function Shopmall:AddJing(playerid,num)
    SrvStore.AddJing(playerid,num,"2",function(success,count)
        print("AddJing response:",success,count)
        if success==true then
            Shopmall:SetStone(playerid,"3",2,count) --刷新晶石数量
        end
    end)
end
function Shopmall:HasItem(playerid,itemname)
    if itemname==nil then
        return false
    end
    local itemdata=self:GetMallState( playerid)
    if itemdata[itemname] then
        return true
    else
        return false
    end
end
function Shopmall:GetItemNum(playerid,itemname)
    local itemdata=self:GetMallState( playerid)
    if itemdata[itemname] then
        return tonumber(itemdata[itemname]['stack'])
    else
        return 0
    end
end
function Shopmall:InitQuest(playerid,ftype)
    print("initquest",playerid,ftype)
    local quest = {}
    if ftype==1 then
        quest["day"]=Shopmall:SetQuest("day",playerid)
    elseif ftype==2 then
        quest["week"]=Shopmall:SetQuest("week",playerid)
    else
        quest["day"]=Shopmall:SetQuest("day",playerid)
        quest["week"]=Shopmall:SetQuest("week",playerid)
    end
    
    Shopmall.unit_quest[playerid] = quest
end
function Shopmall:uploadQuest(times)--统一上传初始化的任务
	if TableLen(Shopmall.unit_quest) == 0 then
		return;
	end
    SrvBattlePass.InitQuest(Shopmall.unit_quest,function(success,arg2)
        if success then
            print("success")
            PrintTable(arg2)
            for k,v in pairs(arg2) do
                local isinitfalse=false --是否初始化失败
                for kk,vv in pairs(v) do
                    if vv~=true then
                        isinitfalse=true --有初始化失败的情况
                    end
                end
                if isinitfalse then --有初始化失败的情况，就把天和周任务都重新初始化
                    local temp={}
                    temp[k]=Shopmall.unit_quest[k]
                    Shopmall:InitQuestAgain(temp,2)---初始化失败再重新初始化该玩家的任务，尝试2次 
                end
            end
            return true
        else
            if times<=0 then
                print("InitQuest ",success,arg2)
                return false
            else
                print("InitQuest ",success,arg2)
                Shopmall:uploadQuest(times-1)
            end
        end
    
    end)
end
function Shopmall:InitQuestAgain(quest,times)
    SrvBattlePass.InitQuest(quest,function(success,arg2)
        if success then
            print("success")
            PrintTable(arg2)
            for k,v in pairs(arg2) do
                local isinitfalse=false --是否初始化失败
                for kk,vv in pairs(v) do
                    if vv~=true then
                        isinitfalse=true --有初始化失败的情况
                    end
                end
                if isinitfalse then --有初始化失败的情况，就把天和周任务都重新初始化
                    --Shopmall:InitQuestAgain(quest,2)---初始化失败再重新初始化该玩家的任务，尝试1次   去掉了，不然成无限提交了
                end
            end
            return true
        else
            if times<=0 then
                print("InitQuest ",success,arg2)
                return false
            else
                print("InitQuest ",success,arg2)
                Shopmall:InitQuestAgain(quest,times-1)
            end
        end
    
    end)
end
function Shopmall:SetQuest(ftype,playerid)
    local quest={}
    local typename=""
    local info={}
    local diffinfo=GetNetTableValue("config","difficulty_modes")
    local maxpass,maxtype,maxdiff=Sachievement:GetMaxdifferent(playerid)
    
    if ftype=="day" then
        typename="quest_day"
    else
        typename="quest_week"
    end
    for i=1,#Shopmall[typename] do
        table.insert(info,i)
    end
    info=RandomNoRepeat(info,3)---随机不重复
    local diffnum=0
    
    for i=1,#info do
        local num=info[i]
        local name=Shopmall[typename][num]['name']
        if string.split(name, "_")[1]=="difficulty" then
            diffnum=diffnum+1
        end
    end
    
    local minnewdiff=1
    local maxnewdiff=7
    local maxdiff = 47
    if (maxpass+2)<=maxdiff then
        minnewdiff=maxpass
        maxnewdiff=maxpass+2
    else
        minnewdiff= maxdiff-2
        maxnewdiff=maxdiff
    end
    local newdifftable={}
    for i=minnewdiff,maxnewdiff do
        table.insert(newdifftable,i)
    end
    local newdiffinfo=RandomNoRepeat(newdifftable,diffnum)---随机不重复 ---随机通关难度的表
    --info={11,12,13}
    local tempnum=1
    for i=1,#info do
        local num=info[i]
        local name=Shopmall[typename][num]['name']
        if string.split(name, "_")[1]=="difficulty" then
            if ftype=="day" then
                name=Shopmall.quest_day_exp[newdiffinfo[tempnum]]['name'] 
                quest[name]={}
                quest[name]['state']="0/"..Shopmall.quest_day_exp[newdiffinfo[tempnum]]['times'] --统一为通关一次
                
            else
                if newdiffinfo[tempnum]>=5 and RollPercent(50) then   --周任务有一定概率随机到特殊任务
                    name=Shopmall.quest_week_2_exp[newdiffinfo[tempnum]]['name'] 
                    quest[name]={}
                    quest[name]['state']="0/"..Shopmall.quest_week_2_exp[newdiffinfo[tempnum]]['times'] --统一为通关五次
                    
                else
                    name=Shopmall.quest_week_1_exp[newdiffinfo[tempnum]]['name'] 
                    quest[name]={}
                    quest[name]['state']="0/"..Shopmall.quest_week_1_exp[newdiffinfo[tempnum]]['times'] --统一为通关五次
                end
            end
            tempnum=tempnum+1
        else
            quest[name]={}
            quest[name]['state']="0/"..Shopmall[typename][num]['times']
        end

        
    end
    return quest
end
function Shopmall:GetPlayerRefreshTimes(playerid)
    local times=0
    local temp=self:GetPlayerBP(playerid)

    if temp.exp.level>=1 then
        times=times+1
    end 
    if temp.exp.level>=17 then
        times=times+1
    end 
    local itemdata=self:GetMallState(playerid)
    if itemdata==nil then
        return 0
    end
    if itemdata[SrvStore.NAME_PLUS] then
        times=times+1
    end
    return times
end
function Shopmall:GetPlayerPluslevel(playerid)  --获取玩家plus是哪种0为没有卡，1为月卡和季卡，3为永久卡
    local itemdata=self:GetMallState(playerid)
    if itemdata==nil then
        return 0
    end
    if itemdata[SrvStore.NAME_PLUS]==nil then
        return 0
    end
    
    if SrvStore.IsPermanent(itemdata[SrvStore.NAME_PLUS]) then
        return 3
    end
    
    return 1
end

function Shopmall:SetPlayerBP(playerid,data,isLast)
    
    --[[for k, v in pairs(data.quest.week) do
         if k=="hero_getboss_1" then
             data.quest.week['hero_getboss_1']=nil
             data.quest.week['hero_killunit_1']={state="0/30000"}
         end
     end]]
     --PrintTable(data)
     local basedata=Sachievement:DeepCopy(Shopmall.battlepass)
     local tmp1,tmp2=math.modf( data.exp / 100 )
     basedata.exp.now=math.ceil(tmp2*100)--当前经验
     basedata.exp.level=tmp1--当前等级
     basedata.exp.max=100--(basedata.exp.level+1)*100 --下一级需要的经验
     Shopmall.unit_battlepass[playerid]=basedata
     local cc=2
     local force=false
     if data.quest==nil then
         cc=14
     else
         basedata.quest=data.quest --不为nil的时候，或者有任务的时候
         if data.quest.day==nil then
             cc=cc+4
         else
            local temp=false
            for k, v in pairs(data.quest.day) do
                if string.split(k, "_")[1]=="difficulty" then
                    temp=true
                    force=true
                end
            end
            if temp==true then
                cc=cc+4
            end
         end
         if data.quest.week==nil then
             cc=cc+8
         else
            local temp=false
            for k, v in pairs(data.quest.week) do
                if string.split(k, "_")[1]=="difficulty" then
                    temp=true
                    force=true
                end
            end
            if temp==true then
                cc=cc+8
            end
         end
     end
     if self.unit_quest[playerid]==nil then --初始化的任务
         if cc==6 then --day
             self:InitQuest(playerid,1)
         elseif cc==10 then --week
             self:InitQuest(playerid,2)
         elseif cc==14 then --day and  week
             self:InitQuest(playerid,3)
         end
     end
     local temp=self:GetPlayerBP(playerid)  --添加初始化的任务
     if cc==6 then --day
         temp.quest.day=self.unit_quest[playerid].day
     elseif cc==10 then --week
         temp.quest.week=self.unit_quest[playerid].week
     elseif cc==14 then --day and  week
         temp.quest=self.unit_quest[playerid]
     end
     if force then
        self.unit_quest[playerid]["force"]=true
     end
     if isLast then
        
        Shopmall:uploadQuest(5)
     end
     
     if data.reward then
         
         for k, v in pairs(data.reward['basic']) do
             if temp.bonus[tonumber(k)][1]['state']==1 then
                 temp.bonus[tonumber(k)][1]['state']=v.time
             end
         end
         for k, v in pairs(data.reward.advanced) do
             if temp.bonus[tonumber(k)][2]['state']==1 then
                 temp.bonus[tonumber(k)][2]['state']=v.time
             end
         end
     end
     for k, v in pairs(temp.quest) do  ---添加经验用来前端显示，主要是上传服务器不能带经验
        if type(v) == 'table' then 
            for kk, vv in pairs(v) do
                for aa, bb in pairs(Shopmall['quest_'..k]) do
                    if kk==bb.name then
                        temp.quest[k][kk]['exp']=bb.exp
                    end
                    if temp.quest[k][kk]['srv_rewarded'] then
                        temp.quest[k][kk]['finish_time']=temp.quest[k][kk]['srv_rewarded']
                    end
                end
                if string.split(kk, "_")[1]=="difficulty" then
                    
                    if k=="day" then
                        temp.quest[k][kk]['exp']=Shopmall.quest_day_exp[tonumber(string.split(kk, "_")[2])]['exp']
                    else
                        if string.split(kk, "_")[3] then   --如果是特殊模式
                            temp.quest[k][kk]['exp']=Shopmall.quest_week_2_exp[tonumber(string.split(kk, "_")[2])]['exp']
                        else
                            temp.quest[k][kk]['exp']=Shopmall.quest_week_1_exp[tonumber(string.split(kk, "_")[2])]['exp']
                        end
                        
                    end
                end
            end
        end
     end
     --PrintTable(temp.quest)
 end
--通行证请求数据
function Shopmall:GetPlayerBP(playerid)
    return Shopmall.unit_battlepass[playerid]
end
--*更新玩家经验（比如直接买经验的，或者其他的某种操作增加了经验的，就用这个）
--UI响应事件： tzj_battlepass_update_exp ,数据： {value = 123456,level = 123456} 
function Shopmall:UpdateBPExp(playerid,expnum)
    
    local data=self:GetPlayerBP(playerid)
    if expnum then
        data.exp.now=tonumber(expnum)
    end
    local tmp1,tmp2 = math.modf(data.exp.now/ 100 )
    data.exp.now=math.ceil(tmp2*100)
    if tmp1>data.exp.level then
        data.exp.level=tmp1
    end
    data.exp.max=100--(data.exp.level+1)*100 --下一级需要的经验
    SendToClient(playerid,"tzj_battlepass_update_exp",{now = data.exp.now,max=data.exp.max,level = data.exp.level})
end

----*更新任务进度
--UI响应事件： tzj_battlepass_update_quest ,数据： {name = "xxxx" ,state = "1/1", time="2021-12-12 12:12:12"} ##progress改成state，新增完成时间字段time（完成的任务才有）
function Shopmall:FinishQuest(playerid,questName,num)
    local data=self:GetPlayerBP(playerid)
    local templist={'day','week'}
    for k, v in pairs(templist) do
        if data.quest[v][questName] and data.quest[v][questName]['finish_time']==nil then
            local numArray=string.split(data.quest[v][questName]['state'], "/")
            local nowcount=tonumber(numArray[1])+num
            local maxcount=tonumber(numArray[2])
            data.quest[v][questName]['state']=nowcount.."/"..maxcount
            if nowcount>=maxcount then
                data.quest[v][questName]['finish_time']="now"
                SrvBattlePass.FinishQuest(playerid,k,questName,data.quest[v][questName],function(success,arg2)
                    if success then
                        self:UpdateBPExp(playerid,arg2['exp'])
                        data.quest[v][questName]['finish_time']=arg2[v][questName]
                        SendToClient(playerid,"tzj_battlepass_update_quest", {name = questName ,quest_type=v,state = data.quest[v][questName]['state'], time=arg2[v][questName]})
                        return true
                    else
                        --print("finishQuest ",success,arg2)
                        return false
                    end
                
                end)
            end
            SendToClient(playerid,"tzj_battlepass_update_quest", {name = questName ,quest_type=v,state =data.quest[v][questName]['state']})
        end 
    end
end
----*更新任务进度批量
--UI响应事件： tzj_battlepass_update_quest ,数据： {name = "xxxx" ,state = "1/1", time="2021-12-12 12:12:12"} ##progress改成state，新增完成时间字段time（完成的任务才有）
---完成多个玩家的多个任务
--@param #table quests 任务信息
--{
--	PlayerID = {
--		day = {--每日任务
--			questName={...}, --任务数据中必须包含exp字段，才会发放通行证经验奖励
--			...
--		},
--		week = {--每周任务
--			questName={...},
--			...
--		}
--	},
--	PlayerID = ...
--}
--@param #function callback 回调函数，调用参数为：
--success(boolean)，是否处理成功
--data，返回值。成功的时候，返回一个表；失败的时候返回错误代码，数字：0=未知错误，1=参数错误，2=DOTA端赛季尚未初始化或当前赛季已经结束,3=DOTA端赛季和服务器赛季不一致
--Shopmall.finish_quest = {}记录完成任务但没上传的任务
--ftype==1 批量完成一个任务直接上传
--ftype==2 批量完成一个任务不上传，只存储
--ftype==3 批量完成一个任务统一上传
function Shopmall:FinishQuestBatch(questName,num,ftype)
   
    local players = PlayerUtil.GetAllPlayersID(false,true)
    local alldata={}
    if ftype==2 or ftype==3 then
        alldata=self.finish_quest  --记录完成任务但没上传的任务
    end
    for _, PlayerID in pairs(players) do
        local data=self:GetPlayerBP(PlayerID)
        local templist={'day','week'}
        for k, v in pairs(templist) do
            if data.quest[v][questName] and data.quest[v][questName]['finish_time']==nil then
                if alldata[PlayerID] ==nil then
                    alldata[PlayerID]={}
                end
                if alldata[PlayerID][v]==nil then
                    alldata[PlayerID][v]={}
                end
                local numArray=string.split(data.quest[v][questName]['state'], "/")
                local nowcount=tonumber(numArray[1])+num
                local maxcount=tonumber(numArray[2])
                if questName=="hero_pass_1" then
                    if Shopmall:Getherotype( PlayerID )==0 then
                        data.quest[v][questName]['state']=nowcount.."/"..maxcount
                        if nowcount>=maxcount then
                            data.quest[v][questName]['finish_time']="now"
                            alldata[PlayerID][v][questName]=data.quest[v][questName]
                        end
                        SendToClient(PlayerID,"tzj_battlepass_update_quest", {name = questName ,quest_type=v ,state =data.quest[v][questName]['state'],}) --完没完成都先更新前端显示数量状态
                    end
                elseif questName=="hero_pass_2" then
                    if Shopmall:Getherotype( PlayerID )==1 then
                        data.quest[v][questName]['state']=nowcount.."/"..maxcount
                        if nowcount>=maxcount then
                            data.quest[v][questName]['finish_time']="now"
                            alldata[PlayerID][v][questName]=data.quest[v][questName]
                        end
                        SendToClient(PlayerID,"tzj_battlepass_update_quest", {name = questName ,quest_type=v ,state =data.quest[v][questName]['state'],}) --完没完成都先更新前端显示数量状态
                    end
                elseif questName=="hero_pass_3" then
                    if Shopmall:Getherotype( PlayerID )==2 then
                        data.quest[v][questName]['state']=nowcount.."/"..maxcount
                        if nowcount>=maxcount then
                            data.quest[v][questName]['finish_time']="now"
                            alldata[PlayerID][v][questName]=data.quest[v][questName]
                        end
                        SendToClient(PlayerID,"tzj_battlepass_update_quest", {name = questName ,quest_type=v ,state =data.quest[v][questName]['state'],}) --完没完成都先更新前端显示数量状态 
                    end
                else
                    data.quest[v][questName]['state']=nowcount.."/"..maxcount
                    if nowcount>=maxcount then
                        data.quest[v][questName]['finish_time']="now"
                        alldata[PlayerID][v][questName]=data.quest[v][questName]
                    end
                    SendToClient(PlayerID,"tzj_battlepass_update_quest", {name = questName ,quest_type=v ,state =data.quest[v][questName]['state'],}) --完没完成都先更新前端显示数量状态
                end
                
            end
            
            
        end
    end
    if ftype==1 then
        if TableLen(alldata) == 0 then
            return;
        end
        SrvBattlePass.FinishQuestsBatch(alldata,function(success,arg2)
            if success then
                print("FinishQuestsBatchsuccess111 ",success)
                --PrintTable(arg2)
                for playerid,v in pairs(arg2) do
                    self:UpdateBPExp(playerid,v['exp'])
                    local templist={'day','week'}
                    for aa, bb in pairs(templist) do  --循环匹配每日每周
                        if v[bb] then
                            for kk,vv in pairs(v[bb]) do
                                local data=self:GetPlayerBP(playerid)
                                data.quest[bb][questName]['finish_time']=vv
                                SendToClient(playerid,"tzj_battlepass_update_quest", {name = kk ,quest_type=v,state = data.quest[bb][questName]['state'], time=vv})
                            end
                        end
                    end
                end
                return true
            else
                print("finishQuest ",success,arg2)
                return false
            end
        end)
    elseif ftype==2 then
        
    elseif ftype==3 then
        SrvBattlePass.FinishQuestsBatch(self.finish_quest,function(success,arg2)
            if success then
                print("finishsuccess333 ",success)
                return true
            else
                print("finishQuest ",success,arg2)
                return false
            end
        end)
    end
end
function Shopmall:GetQuestNoFinish(PlayerID)
    local alldata={}
    local data=self:GetPlayerBP(PlayerID)
    local templist={'day','week'}
    for k, v in pairs(templist) do
        if data.quest[v] then
            for kk,vv in pairs(data.quest[v]) do
                local numArray=string.split(vv['state'], "/")
                if vv.finish_time==nil and tonumber(numArray[1])~=0 then
                    if alldata[v]==nil then
                        alldata[v]={}
                    end
                    vv.exp=nil---未完成的任务不传经验
                    alldata[v][kk]=vv
                end
            end    
        end
    end
    return alldata
end
--界面初始化完毕会调发送 tzj_battlepass_init 事件，向dota端请求玩家数据，没有的话不用做任何返回，有了就返回玩家上边的所有数据就行了（响应事件：tzj_battlepass_init_return）。
--这样做的目的主要是为了在玩家断线重连的时候，能够正常获得数据
function Shopmall:tzj_battlepass_init(data)
    --if GameRules:IsGamePaused() then return end
    local player = PlayerResource:GetPlayer(data.PlayerID)
    if player == nil then return end
    --local hero = player:GetAssignedHero()
    --if not EntityIsAlive(hero) then return end
    local playerdata=Shopmall:GetPlayerBP(data.PlayerID)
    if playerdata then
        SendToClient(data.PlayerID,"tzj_battlepass_init_return",playerdata)
    end
end
--*领取奖励data.level=1
--UI发送事件：tzj_battlepass_request_get_reward ,数据： {level = 1,bptype=1/2（通行类型1代表普通，2代表进阶）} --发送要领取的等级  ##添加通行证类型
--UI响应事件：tzj_battlepass_update_reward ,数据： {level = 1, success = true/false} --领取的等级，是否成功
--{bptype=1/2（通行证类型1代表普通，2代表进阶）,level = 1, success = true/false,time="2021-12-12 12:12:12"（奖励领取时间，只有上边写的bonus的received=1的才会有这一项）} --领取的等级，是否成功 ##添加通行证版本和领取时间
function Shopmall:tzj_battlepass_request_get_reward(data)
	local player = PlayerResource:GetPlayer(data.PlayerID)
    if player == nil then return end
    --local hero = player:GetAssignedHero()
    --if not EntityIsAlive(hero) then return end
    local playerdata=Shopmall:GetPlayerBP(data.PlayerID)
    if tonumber(data.level)<=playerdata.exp.level then --等级判断
        local setdata={}
        local ftype='basic'
        if data.bptype==2 then
            ftype='advanced'
          if  Shopmall:HasItem(data.PlayerID,"shopmall_1")==false then
                SendToClient(data.PlayerID,"tzj_battlepass_update_reward",{bptype=data.bptype,level = data.level, success = false,time=nil})
                return false
          end
        end
        local count=0
        
        setdata[ftype]={}
        setdata[ftype][tostring(data.level)]={}
        setdata[ftype][tostring(data.level)]['name']=playerdata.bonus[data.level][data.bptype]['name']
        if string.split(playerdata.bonus[data.level][data.bptype]['name'], "_")[1]=='jing'  then
            count=Shopmall['BPreward_'..data.bptype][data.level]['Giveshopmall']
            setdata[ftype][tostring(data.level)]['name']='jing_stone'
        elseif string.split(playerdata.bonus[data.level][data.bptype]['name'], "_")[1]=='shopmall' then
            count=Shopmall['BPreward_'..data.bptype][data.level]['Giveshopmall']
        else
            setdata[ftype][tostring(data.level)]['noStore']=playerdata.bonus[data.level][data.bptype]['noStore']
        end
        if Shopmall:IsUnique( setdata[ftype][tostring(data.level)]['name'] ) then
            count=nil
        end
        setdata[ftype][tostring(data.level)]['count']=count
        SrvBattlePass.ReceiveReward(data.PlayerID,setdata,function(success,arg2,arg3)
            if success then
                --print("ReceiveReward1111 ",success,arg2)
                if arg2 then
                    Shopmall:SetStone(data.PlayerID,"3",2,arg2) --刷新晶石数量
                end
                local oldnum=Shopmall:GetItemNum(data.PlayerID,playerdata.bonus[data.level][data.bptype]['name'])
                
                Shopmall:UpdatePlayerdata( data.PlayerID,playerdata.bonus[data.level][data.bptype]['name'],count+oldnum,arg3[ftype][tostring(data.level)])  --刷新商城物品
                SendToClient(data.PlayerID,"tzj_battlepass_update_reward",{bptype=data.bptype,level = data.level, success = true,time=arg3[ftype][tostring(data.level)]})
                return true
            else
                print("ReceiveReward ",success,arg2)
                SendToClient(data.PlayerID,"tzj_battlepass_update_reward",{bptype=data.bptype,level = data.level, success = false,time=arg3[ftype][tostring(data.level)]})
                return false
            end
        
        end)
    else
        SendToClient(data.PlayerID,"tzj_battlepass_update_reward",{bptype=data.bptype,level = data.level, success = false,time=nil})
    end
    
end


--消耗物品
--data.itemname 物品名称
function Shopmall:shopmallconsumeitem(data)
    if GameRules:IsGamePaused() then 
        local params = {success=false,item=data.itemname,ui=data.ui}
        params.info = "#consumefail";
        SendToClient(data.PlayerID,"ui_event_shopmall_consume_return",params)
        return 
    end
    
    if GameRules:GetGameModeEntity().consumetime==nil  then
        GameRules:GetGameModeEntity().consumetime={}
    end
    if GameRules:GetGameModeEntity().consumetime[data.PlayerID]==nil  then
        GameRules:GetGameModeEntity().consumetime[data.PlayerID]=0
    end

    if GameRules:GetGameModeEntity().consumetime[data.PlayerID]>Time() then
        local params = {success=false,item=data.itemname,ui=data.ui}
        params.info = "#consumefail";
        SendToClient(data.PlayerID,"ui_event_shopmall_consume_return",params)
        return 
    end
    GameRules:GetGameModeEntity().consumetime[data.PlayerID]=Time()+0.2

	local player = PlayerResource:GetPlayer(data.PlayerID)
    if player == nil then 
        local params = {success=false,item=data.itemname,ui=data.ui}
        params.info = "#consumefail";
        SendToClient(data.PlayerID,"ui_event_shopmall_consume_return",params)
        return 
    end
    local hero = player:GetAssignedHero()
    if not EntityIsAlive(hero) then 
        local params = {success=false,item=data.itemname,ui=data.ui}
        params.info = "#consumefail";
        SendToClient(data.PlayerID,"ui_event_shopmall_consume_return",params)
        return 
    end
    if data.itemname then
        local alldata=Shopmall.list
        local item=alldata[data.itemname]
        if item.canuse==false then
            local params = {success=false,item=data.itemname,ui=data.ui}
            params.info = "#consumefail";
            SendToClient(data.PlayerID,"ui_event_shopmall_consume_return",params)
            return 
        end
        if  item==nil  then
            local params = {success=false,item=data.itemname,ui=data.ui}
            params.info = "#consumefail2";
            SendToClient(data.PlayerID,"ui_event_shopmall_consume_return",params)
        end
        if Shopmall:HasItem(data.PlayerID,data.itemname) then
            if string.split(data.itemname, "_")[2]=="cw" then
                Shopmall:SetReWard( hero,item.reward)
                SendToClient(data.PlayerID,"ui_event_shopmall_consume_return",{success=true,item=data.itemname,ui=data.ui})
               return
            end
            if string.split(data.itemname, "_")[2]=="gh" then
                Shopmall:SetReWard( hero,item.reward)
                SendToClient(data.PlayerID,"ui_event_shopmall_consume_return",{success=true,item=data.itemname,ui=data.ui})
               return
            end
            if string.split(data.itemname, "_")[2]=="ch" then
                Shopmall:SetReWard( hero,item.reward)
                SendToClient(data.PlayerID,"ui_event_shopmall_consume_return",{success=true,item=data.itemname,ui=data.ui})
               return
            end
            if item['cooldown'] then
                local endtime=PlayerUtil.getAttrByPlayer(data.PlayerID,data.itemname.."_endtime")
                if endtime then
                    if endtime>GameRules:GetGameTime() then
                        SendToClient(data.PlayerID,"ui_event_shopmall_consume_return",{success=false,item=data.itemname,ui=data.ui,info="#info_exceedthecooltime",cooldown=endtime})
                        return 
                    else
                    	endtime = GameRules:GetGameTime()+item['cooldown'];
                        PlayerUtil.setAttrByPlayer(data.PlayerID,data.itemname.."_endtime",endtime) 
                        SendToClient(data.PlayerID,"tzj_minimap_action_cooldown",{item=data.itemname,cooldown=endtime})
                    end
                else
                	endtime = GameRules:GetGameTime()+item['cooldown'];
                    PlayerUtil.setAttrByPlayer(data.PlayerID,data.itemname.."_endtime",endtime) 
                    SendToClient(data.PlayerID,"tzj_minimap_action_cooldown",{item=data.itemname,cooldown=endtime})
                end
            end
            local exceedLimit=false
            local lasttimes=1 --剩余使用次数
            local hasnum=Shopmall:GetItemNum(data.PlayerID,data.itemname)--拥有的数量
            local clintnum=1--客户端传过来的数量
            if data.count then
                clintnum= tonumber(data.count) 
            end
            if item['maxtimes'] then
                local usetimes=PlayerUtil.getAttrByPlayer(data.PlayerID,data.itemname.."_usetimes")
                if usetimes then
                    lasttimes=item['maxtimes']-usetimes
                else
                    lasttimes=item['maxtimes']
                end
            end
            local count=math.min(unpack({lasttimes,clintnum,hasnum})) --3者取最小，nil的时候不作判断
            local alldata=Shopmall.list
            local item=alldata[data.itemname]
            if item.stack==nil then
                count=nil
            end
            local reward=nil
            if count~=nil and count<=0 then  --为0表示不能使用，要么数量限制到了要么拥有0个
                local params = {success=false,item=data.itemname,ui=data.ui,exceedLimit=exceedLimit}      
             	params.info = "#consumefail";
                SendToClient(data.PlayerID,"ui_event_shopmall_consume_return",params)
                return 
            end
            if item['maxtimes'] and count~=nil then
                local usetimes=PlayerUtil.getAttrByPlayer(data.PlayerID,data.itemname.."_usetimes")
                if usetimes then
                    if usetimes>=item['maxtimes'] then
                        SendToClient(data.PlayerID,"ui_event_shopmall_consume_return",{success=false,item=data.itemname,ui=data.ui,info="#info_exceedthelimit",exceedLimit=true})
                        return 
                    else
                        if usetimes+count==item['maxtimes'] then
                            exceedLimit=true
                        end
                       PlayerUtil.setAttrByPlayer(data.PlayerID,data.itemname.."_usetimes",usetimes+count) 
                    end
                else
                    if item['maxtimes']==count then
                        exceedLimit=true
                    end
                    PlayerUtil.setAttrByPlayer(data.PlayerID,data.itemname.."_usetimes",count) 
                end
            end
            
            for i=1,math.max(unpack({1,count})) do  --最少使用一次
                Shopmall:SetReWard( hero,item.reward,data.itemname)
            end
            SrvStore.ConsumeItem(data.PlayerID,data.itemname,count,reward,function(success,newItem)
                if success==true then
                    if newItem then
                        Shopmall:UpdatePlayerdata( data.PlayerID,data.itemname,newItem['stack'],newItem['invalid_time'])
                    end
                end
                local params = {success=success,item=data.itemname,ui=data.ui,exceedLimit=exceedLimit}
                if not success then
                	--如果是明确的原因，且是玩家的原因导致，就返回相应的错误原因。如果是未知的错误，或者是系统方面的错误，则返回通用的“使用失败，请稍后再试”之类的原因。
                	params.info = "#consumefail";
                end
                SendToClient(data.PlayerID,"ui_event_shopmall_consume_return",params)
            end)
        end
        
    end
end
--开箱子
function Shopmall:tzj_chest_open(data)
    --if GameRules:IsGamePaused() then return end
    local player = PlayerResource:GetPlayer(data.PlayerID)
    if player == nil then return end
    local hero = player:GetAssignedHero()
    local itemdata=Shopmall:GetMallState( data.PlayerID)
    if itemdata[data.itemName]==nil then
        SendToClient(data.PlayerID,"tzj_chest_open_result",{info="#invite_fail1",ui=data.ui})
        return 
    end
    if itemdata[data.itemName]['stack']<data.count then --判断钥匙数量
        SendToClient(data.PlayerID,"tzj_chest_open_result",{info="#keybox_fail1",ui=data.ui})
        return 
    end
    if data.itemName~="shopmall_68" and Netbackpack:GetNotUseNum( hero )<data.count then--判断背包数量
        SendToClient(data.PlayerID,"tzj_chest_open_result",{info="#keybox_fail2",ui=data.ui})
        return 
    end
    if data.itemName~="shopmall_88" and Netbackpack:GetNotUseNum( hero )<data.count then--判断背包数量
        SendToClient(data.PlayerID,"tzj_chest_open_result",{info="#keybox_fail2",ui=data.ui})
        return 
    end
    if data.itemName~="shopmall_89" and Netbackpack:GetNotUseNum( hero )<data.count then--判断背包数量
        SendToClient(data.PlayerID,"tzj_chest_open_result",{info="#keybox_fail2",ui=data.ui})
        return 
    end
    if data.itemName~="shopmall_90" and Netbackpack:GetNotUseNum( hero )<data.count then--判断背包数量
        SendToClient(data.PlayerID,"tzj_chest_open_result",{info="#keybox_fail2",ui=data.ui})
        return 
    end
    for i=1,tonumber(data.count) do
        Shopmall:SetReWard( hero,Shopmall.list[data.itemName]['reward'])
    end
	--data.ui
    local alldata=Shopmall.list
    local item=alldata[data.itemName]
    if  item==nil  then
        SendToClient(data.PlayerID,"tzj_chest_open_result",{info="#consumefail2",ui=data.ui})
        return
    end
    if Shopmall:HasItem(data.PlayerID,data.itemName) then
        local count=data.count
        local reward={}
        local equips = {}
        if Netbackpack.UnitKeyItems[data.PlayerID]~=nil then
        	local temp = Netbackpack.UnitKeyItems[data.PlayerID]
            for k,equip in pairs(temp) do 
                equip.src = data.itemName  --添加来源
                local equipEntity = EntIndexToHScript( equip.entityindex )
                if equipEntity then
                	equips[equip.slot] = equipEntity
                end
            end
            reward=temp
            
        end
        local LotteryResult={}
        if data.itemName=="shopmall_68" then    --通用宝箱
            reward={}
            LotteryResult=Lottery:RandomLottery(data.PlayerID,count,1)
            for k,v in pairs(LotteryResult) do
                local tempitem={}
                tempitem.name=v.item
                tempitem.count=v.count
                tempitem.type=1
                if v.jing~=0 then
                    tempitem.jing=v.jing
                end
                table.insert(reward,tempitem)
                
            end
        end
        if data.itemName=="shopmall_88" then    --二级通用宝箱
            reward={}
            LotteryResult=Lottery:RandomLottery(data.PlayerID,count,2)
            for k,v in pairs(LotteryResult) do
                local tempitem={}
                tempitem.name=v.item
                tempitem.count=v.count
                tempitem.type=1
                if v.jing~=0 then
                    tempitem.jing=v.jing
                end
                table.insert(reward,tempitem)
                
            end
        end
        if data.itemName=="shopmall_89" then    --三级通用宝箱
            reward={}
            LotteryResult=Lottery:RandomLottery(data.PlayerID,count,3)
            for k,v in pairs(LotteryResult) do
                local tempitem={}
                tempitem.name=v.item
                tempitem.count=v.count
                tempitem.type=1
                if v.jing~=0 then
                    tempitem.jing=v.jing
                end
                table.insert(reward,tempitem)
                
            end
        end
        if data.itemName=="shopmall_90" then    --四级通用宝箱
            reward={}
            LotteryResult=Lottery:RandomLottery(data.PlayerID,count,4)
            for k,v in pairs(LotteryResult) do
                local tempitem={}
                tempitem.name=v.item
                tempitem.count=v.count
                tempitem.type=1
                if v.jing~=0 then
                    tempitem.jing=v.jing
                end
                table.insert(reward,tempitem)
                
            end
        end
        SrvStore.ConsumeItem(data.PlayerID,data.itemName,count,reward,function(success,newItem,rewardData)
            local tempparams={ui=data.ui}
            if success==true then
                Netbackpack.UnitKeyItems[data.PlayerID]=nil  --把暂存数据清空
                Netbackpack:UpdateItem( hero, 1 )
                if newItem then
                    Shopmall:UpdatePlayerdata( data.PlayerID,data.itemName,newItem['stack'],newItem['invalid_time'])
                end
                
                if rewardData then
                    tempparams.item=LotteryResult
                    if rewardData.jing then
                        Shopmall:SetStone(data.PlayerID,"init",2,rewardData.jing)
                    end
                    if rewardData.store_items then
                        for k,v in pairs(rewardData.store_items) do
                            Shopmall:UpdatePlayerdata( data.PlayerID,k,v['stack'],v['invalid_time'])
                        end
                    end
                    
                	if rewardData.net_equip then
						local slotMap = {}
						for _, var in pairs(rewardData.net_equip) do
							slotMap[var.slot] = var
						end
						local netEquips = {}
						--更新装备上记录的服务器id，否则其他操作都不能进行
						for slot, equip in pairs(equips) do
							local serverItem = slotMap[tostring(slot)]
							if serverItem then
								equip.serverID = serverItem.id
								table.insert(netEquips,serverItem)
							end
						end
						--更新缓存数据
						SrvNetEquip.UpdateEquipCache(data.PlayerID,netEquips)          		
                	end
                end
                
                -- SendToClient(data.PlayerID,"tzj_chest_open_result",params)
                --客户端响应事件：tzj_chest_open_result
                -- 响应数据：
                --{
                    --  item = 1 / [1,2,3,.....], ---获得的存档装备的id（对应entity的index），可以是一个数字（如果只开了一个箱子），也可以是一个数组（开了多个箱子），每个数组元素都是一个实体id
                    --max_quality = 4 ---获得的所有装备里的最高级品质
                    
                    
                    --info = "xxxxxx" ---错误信息，开启失败的时候才需要传这个。 没有就不传
                    --infoKV = {k=v} ---错误信息的格式化数据，需要格式化再传，不需要的时候传nil
                
                --}
                local max_quality=0
                if data.itemName~="shopmall_68" and data.itemName~="shopmall_88"  then
                    if data.itemName~="shopmall_89" and data.itemName~="shopmall_90"  then
                        if #reward==1 then
                            tempparams.item=reward[1]['entityindex']
                            max_quality = reward[1].quality
                        else
                            tempparams.item={}
                            for k,v in pairs(reward) do 
                                table.insert(tempparams.item,v.entityindex)
                                if v.quality>max_quality then
                                    max_quality=v.quality
                                end
                            end
                        end
                        tempparams.max_quality=max_quality
                    end
                end
                
            else
                local temp = Netbackpack.UnitKeyItems[data.PlayerID]
                local pack = Netbackpack:GetNetbackpack(hero)
                for k,equip in pairs(temp) do 
                    if pack then
                        pack[equip.slot] = -1
                    end
                end
                Netbackpack.UnitKeyItems[data.PlayerID]=nil  --把暂存数据清空
                Netbackpack:UpdateItem( hero, 1 )
                tempparams.info= "#info_operation_faild"
            end
           
            SendToClient(data.PlayerID,"tzj_chest_open_result",tempparams)
        end)
        
    else
    	SendToClient(data.PlayerID,"tzj_chest_open_result",{info="#consumefail2",ui=data.ui})
    end
            
    
end
-- 购买物品
--data.itemname 物品名称11
--data.count 物品数量
function Shopmall:shopmallbuyitem(data)
    --if GameRules:IsGamePaused() then return end
 -- PrintTable(data)
    if GameRules:GetGameModeEntity().buyshoptime==nil  then
        GameRules:GetGameModeEntity().buyshoptime={}
    end
    if GameRules:GetGameModeEntity().buyshoptime[data.PlayerID]==nil  then
        GameRules:GetGameModeEntity().buyshoptime[data.PlayerID]=0
    end

    if GameRules:GetGameModeEntity().buyshoptime[data.PlayerID]>Time() then
        SendToClient(data.PlayerID,"ui_event_buymallitem_return",{state=false,itemname=data.itemname,info="#info_cantbuy"})
        return 
    end
    GameRules:GetGameModeEntity().buyshoptime[data.PlayerID]=Time()+0.2

    
	local player = PlayerResource:GetPlayer(data.PlayerID)
    if player == nil then return end
    local hero = player:GetAssignedHero()
    if not EntityIsAlive(hero) then return end
    if data.itemname then
        local alldata=Shopmall.list
        local item=alldata[data.itemname]
        if  item==nil  then
            return
        end
        local ftype=1
        if data.currency then
            ftype=data.currency
        end
        local price=0
        local count=1
        local validDays=1
        if item["validDays"] then
            validDays=item["validDays"]
        else
            validDays=nil ---没有时间限制不传validDays
        end
        if item["stack"] then
            count=data.count
        else
            if Shopmall:HasItem(data.PlayerID,data.itemname) and validDays==nil then  --非消耗品，已经有了就不能再买了,但是月卡之类在有限时间的依然可以买
                CustomGameEventManager:Send_ServerToPlayer(player,"ui_event_buymallitem_return",{state=false,itemname=data.itemname,info="#info_cantbuy"})
                return false
            end
            count=1
        end

        if ftype==1 then
            price=item["price_magic"]*count
        else
            price=item["price_jing"]*count
        end
        if item["stack"]==nil then ---非消耗品不传count
            count=nil
        end
        if item["limit"] then
            maplevel=SrvMapLevel.GetPlayerLevel(data.PlayerID)-1
            if maplevel<item["limit"]["maplevel"] then
                SendToClient(data.PlayerID,"ui_event_buymallitem_return",{state=false,itemname=data.itemname,info="#info_maplevelnolimit",infoKV={level=item["limit"]["maplevel"]}})
                return
            end
        end
        local itemdata=Shopmall:GetMallState(data.PlayerID)
        if data.itemname=="shopmall_1" then
            SrvStore.BuyBattlePass(data.PlayerID,price,500,function(success,item,money,battlePass)
                if success then
                    Shopmall:UpdateBPExp(data.PlayerID,battlePass.exp)
                    Shopmall:SetStone(data.PlayerID,"3",ftype,money)
                    Shopmall:UpdatePlayerdata( data.PlayerID,data.itemname,item['stack'],item['invalid_time'])
                    SendToClient(data.PlayerID,"ui_event_buymallitem_return",{state=success,itemname=data.itemname,stack=count,total=item.stack})
                else
                    print(item,"BuyItem  pass  response :",success,money)
                    SendToClient(data.PlayerID,"ui_event_buymallitem_return",{state=success,itemname=data.itemname,info="#info_mall_error"})
                end
            
            end)
        elseif  data.itemname=="shopmall_2" then
            if SrvStore.IsPermanent(itemdata[SrvStore.NAME_PLUS]) then
                SendToClient(data.PlayerID,"ui_event_buymallitem_return",{state=false,itemname=data.itemname,info="#info_cantbuy"})
                return false
            end
            local reward=nil
            SrvStore.BuyPlus(data.PlayerID,price,validDays,reward,function(success,item,money,rewardback)
                if success then
                    Shopmall:SetStone(data.PlayerID,"3",ftype,money)
                    Shopmall:UpdatePlayerdata( data.PlayerID,SrvStore.NAME_PLUS,item['stack'],item['invalid_time'])
                    SendToClient(data.PlayerID,"ui_event_buymallitem_return",{state=success,itemname=data.itemname,plus=true,day=validDays,invalid=item['invalid_time']})
                else
                    print(item,"BuyItem  pass  response :",success,money)
                    SendToClient(data.PlayerID,"ui_event_buymallitem_return",{state=success,itemname=data.itemname,plus=true,info="#info_mall_error"})
                end
            
            end)
        elseif  data.itemname=="shopmall_45" then
            if SrvStore.IsPermanent(itemdata[SrvStore.NAME_PLUS]) then
                SendToClient(data.PlayerID,"ui_event_buymallitem_return",{state=false,itemname=data.itemname,info="#info_cantbuy"})
                return false
            end
            local reward=nil
            SrvStore.BuyPlus(data.PlayerID,price,validDays,reward,function(success,item,money,rewardback)
                if success then
                    Shopmall:SetStone(data.PlayerID,"3",ftype,money)
                    Shopmall:UpdatePlayerdata( data.PlayerID,SrvStore.NAME_PLUS,item['stack'],item['invalid_time'])
                    SendToClient(data.PlayerID,"ui_event_buymallitem_return",{state=success,itemname=data.itemname,plus=true,day=validDays,invalid=item['invalid_time']})
                else
                    print(item,"BuyItem  pass  response :",success,money)
                    SendToClient(data.PlayerID,"ui_event_buymallitem_return",{state=success,itemname=data.itemname,plus=true,info="#info_mall_error"})
                end
            
            end)
        elseif  data.itemname=="shopmall_46" then
            if SrvStore.IsPermanent(itemdata[SrvStore.NAME_PLUS]) then
                SendToClient(data.PlayerID,"ui_event_buymallitem_return",{state=false,itemname=data.itemname,info="#info_cantbuy"})
                return false
            end
        	validDays = -1
            local reward={{item="shopmall_cw_3_11",count=1,valid=nil}}
            SrvStore.BuyPlus(data.PlayerID,price,validDays,reward,function(success,item,money,rewardback)
                if success then
                    if rewardback then
                        for k,v in pairs(rewardback) do
                            Shopmall:UpdatePlayerdata( data.PlayerID,k,v.stack,v.invalid_time)  --刷新商城物品
                        end
                    end
                    Shopmall:SetStone(data.PlayerID,"3",ftype,money)
                    Shopmall:UpdatePlayerdata( data.PlayerID,SrvStore.NAME_PLUS,item['stack'],item['invalid_time'])
                    SendToClient(data.PlayerID,"ui_event_buymallitem_return",{state=success,itemname=data.itemname,plus=true,day=validDays,invalid=item['invalid_time']})
                else
                    print(item,"BuyItem  pass  response :",success,money)
                    SendToClient(data.PlayerID,"ui_event_buymallitem_return",{state=success,itemname=data.itemname,plus=true,info="#info_mall_error"})
                end
            
            end)
        else
            if count then  --有值表示为消耗品
                if 	data.currency then
                    ftype=data.currency
                end
                SrvStore.BuyStackableItem(data.PlayerID,data.itemname,price,ftype,count,function(success,key2,money)
                    if success then
                        Shopmall:SetStone(data.PlayerID,"3",ftype,money)
                        Shopmall:UpdatePlayerdata( data.PlayerID,data.itemname,key2['stack'],key2['invalid_time'])
                        SendToClient(data.PlayerID,"ui_event_buymallitem_return",{state=success,itemname=data.itemname,stack=count,total=key2.stack})
                    else
                        print(key2,"BuyItem  XIAN response :",success,money)
                        SendToClient(data.PlayerID,"ui_event_buymallitem_return",{state=success,itemname=data.itemname,info="#info_mall_error"})
                    end
                
                end)
            else
                local reward=nil
                SrvStore.BuyUniqueItem(data.PlayerID,data.itemname,price,ftype,reward,function(success,key2,money,rewardback)
                    if success then
                        if rewardback then
                            for k,v in pairs(rewardback) do
                                Shopmall:UpdatePlayerdata( data.PlayerID,k,v.stack,v.invalid_time)  --刷新商城物品
                            end
                        end
                        Shopmall:SetStone(data.PlayerID,"3",ftype,money)
                        Shopmall:UpdatePlayerdata( data.PlayerID,data.itemname,key2['stack'],key2['invalid_time'])
                        SendToClient(data.PlayerID,"ui_event_buymallitem_return",{state=success,itemname=data.itemname,stack=count,total=key2.stack})
                    else
                        print(key2,"BuyItem  XIAN response :",success,money)
                        SendToClient(data.PlayerID,"ui_event_buymallitem_return",{state=success,itemname=data.itemname,info="#info_mall_error"})
                    end
                
                end)
            end
            
        end
        
        
        
    end
end
function Shopmall:tzj_rune_init(data)
    --local player = PlayerResource:GetPlayer(data.PlayerID)
    --if player == nil then return end
    --local hero = player:GetAssignedHero()

    local allname={"shopmall_15","shopmall_16","shopmall_17","shopmall_47","shopmall_48"}
    local fwlist={}
    for k,v in pairs(allname) do
        local maxtimes=Shopmall.list[v]['maxtimes']
        local lasttime=0
        if maxtimes==nil then
            maxtimes=0
        end
        lasttime=maxtimes
        local usetimes=PlayerUtil.getAttrByPlayer(data.PlayerID,v.."_usetimes")
        if usetimes then
            lasttime=maxtimes-usetimes
        end
        fwlist[v]=lasttime
    end
    SendToClient(data.PlayerID,"tzj_rune_init_return",{rune=Shopmall.playerzc[data.PlayerID],max=fwlist})
end
-- 购买物品
CustomGameEventManager:RegisterListener("ui_event_buymallitem",Dynamic_Wrap(Shopmall,"shopmallbuyitem"))
-- 消耗物品
CustomGameEventManager:RegisterListener("ui_event_consumemallitem",Dynamic_Wrap(Shopmall,"shopmallconsumeitem"))
-- 请求玩家数据
CustomGameEventManager:RegisterListener("tzj_battlepass_init",Dynamic_Wrap(Shopmall,"tzj_battlepass_init"))
--*领取奖励
 --UI发送事件：tzj_battlepass_request_get_reward ,数据： {level = 1,bptype=1/2（通行类型1代表普通，2代表进阶）}发送要领取的等级  ##添加通行证类型
CustomGameEventManager:RegisterListener("tzj_battlepass_request_get_reward",Dynamic_Wrap(Shopmall,"tzj_battlepass_request_get_reward"))
--开箱子
CustomGameEventManager:RegisterListener("tzj_chest_open",Dynamic_Wrap(Shopmall,"tzj_chest_open"))
--获取专长
CustomGameEventManager:RegisterListener("tzj_rune_init",Dynamic_Wrap(Shopmall,"tzj_rune_init"))

