
item_suit_table = {
	["item_tz_3_1"]={
		["buff"] ="modifers_item_set_01",
		["Item"] = {"item_tz_3_1_1","item_tz_3_1_2","item_tz_3_1_3"},
	},
	["item_tz_3_2"]={
		["buff"] ="modifers_item_set_02",
		["Item"] = {"item_tz_3_2_1","item_tz_3_2_2","item_tz_3_2_3"},
	},
	["item_tz_3_3"]={
		["buff"] ="modifers_item_set_03",
		["Item"] = {"item_tz_3_3_1","item_tz_3_3_2","item_tz_3_3_3"},
	},
	["item_tz_3_4"]={
		["buff"] ="modifers_item_set_04",
		["Item"] = {"item_tz_3_4_1","item_tz_3_4_2","item_tz_3_4_3"},
	},
	["item_tz_4_1"]={
		["buff"] ="modifers_item_set_05",
		["Item"] = {"item_tz_4_1_1","item_tz_4_1_2","item_tz_4_1_3"},
	},
	["item_tz_4_2"]={
		["buff"] ="modifers_item_set_06",
		["Item"] = {"item_tz_4_2_1","item_tz_4_2_2","item_tz_4_2_3"},
	},
	["item_tz_4_3"]={
		["buff"] ="modifers_item_set_07",
		["Item"] = {"item_tz_4_3_1","item_tz_4_3_2","item_tz_4_3_3"},
	},
	["item_tz_4_4"]={
		["buff"] ="modifers_item_set_08",
		["Item"] = {"item_tz_4_4_1","item_tz_4_4_2","item_tz_4_4_3"},
	},
	["item_tz_4_5"]={
		["buff"] ="modifers_item_set_09",
		["Item"] = {"item_tz_4_5_1","item_tz_4_5_2","item_tz_4_5_3"},
	},
	["item_tz_4_6"]={
		["buff"] ="modifers_item_set_10",
		["Item"] = {"item_tz_4_6_1","item_tz_4_6_2","item_tz_4_6_3"},
	},
	["item_tz_4_7"]={
		["buff"] ="modifers_item_set_11",
		["Item"] = {"item_tz_4_7_1","item_tz_4_7_2","item_tz_4_7_3"},
	},
	["item_tz_4_8"]={
		["buff"] ="modifers_item_set_12",
		["Item"] = {"item_tz_4_8_1","item_tz_4_8_2","item_tz_4_8_3"},
	},
	["item_tz_5_1"]={
		["buff"] ="modifers_item_set_13",
		["Item"] = {"item_tz_5_1_1","item_tz_5_1_2","item_tz_5_1_3"},
	},
	["item_tz_5_2"]={
		["buff"] ="modifers_item_set_14",
		["Item"] = {"item_tz_5_2_1","item_tz_5_2_2","item_tz_5_2_3"},
	},
	["item_tz_5_3"]={
		["buff"] ="modifers_item_set_15",
		["Item"] = {"item_tz_5_3_1","item_tz_5_3_2","item_tz_5_3_3"},
	},
	["item_tz_5_4"]={
		["buff"] ="modifers_item_set_16",
		["Item"] = {"item_tz_5_4_1","item_tz_5_4_2","item_tz_5_4_3"},
	},
}
LinkLuaModifier( "modifers_item_set_01","lua_modifiers/suit_item/modifers_item_set_01", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifers_item_set_02","lua_modifiers/suit_item/modifers_item_set_02", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifers_item_set_03","lua_modifiers/suit_item/modifers_item_set_03", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifers_item_set_03_aura","lua_modifiers/suit_item/modifers_item_set_03_aura", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifers_item_set_04","lua_modifiers/suit_item/modifers_item_set_04", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifers_item_set_05","lua_modifiers/suit_item/modifers_item_set_05", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifers_item_set_06","lua_modifiers/suit_item/modifers_item_set_06", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifers_item_set_07","lua_modifiers/suit_item/modifers_item_set_07", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifers_item_set_08","lua_modifiers/suit_item/modifers_item_set_08", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifers_item_set_09","lua_modifiers/suit_item/modifers_item_set_09", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifers_item_set_10","lua_modifiers/suit_item/modifers_item_set_10", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifers_item_set_11","lua_modifiers/suit_item/modifers_item_set_11", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifers_item_set_12","lua_modifiers/suit_item/modifers_item_set_12", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifers_item_set_13","lua_modifiers/suit_item/modifers_item_set_13", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifers_item_set_14","lua_modifiers/suit_item/modifers_item_set_14", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifers_item_set_15","lua_modifiers/suit_item/modifers_item_set_15", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifers_item_set_16","lua_modifiers/suit_item/modifers_item_set_16", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifers_item_set_10_buff","lua_modifiers/suit_item/modifers_item_set_10_buff", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifers_item_set_04_aura_debuff","lua_modifiers/suit_item/modifers_item_set_04_aura_debuff", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifers_item_set_11_aura_debuff","lua_modifiers/suit_item/modifers_item_set_11_aura_debuff", LUA_MODIFIER_MOTION_NONE )
LinkLuaModifier( "modifers_item_set_12_aura","lua_modifiers/suit_item/modifers_item_set_12_aura", LUA_MODIFIER_MOTION_NONE )

function suit_equip(event)
	local caster=event.caster
	if caster==nil then
		return
	end
	local ab= event.ability
	local itemsuit=string.sub(ab:GetAbilityName(),1,string.len(ab:GetAbilityName())-2)
	local composeItem = {}
    --table.insert(composeItem,ab)
	local suit=item_suit_table[itemsuit]
	Timers:CreateTimer( 0.3, function()
		for k1,v1 in pairs(suit["Item"]) do
			for item_slot = 0,5 do
				local item = caster:GetItemInSlot(item_slot)
				if item ~= nil then
					if item:GetAbilityName() == v1 then
						table.insert(composeItem,item)
						break
					end
				end
			end
		end
		if (#composeItem) == (#suit["Item"]) then
			caster:AddNewModifier(caster,nil,suit["buff"],{})
		end
		return nil
	end )
end
function suit_unequip(event)
	
	local caster=event.caster
	if caster==nil then
		return
	end
	local ab = event.ability
	local itemsuit=string.sub(ab:GetAbilityName(),1,string.len(ab:GetAbilityName())-2)
	local suit=item_suit_table[itemsuit]
	caster:RemoveModifierByName(suit["buff"])
	Timers:CreateTimer( 0.3, function()
		local composeItem = {}
		for k1,v1 in pairs(suit["Item"]) do
			for item_slot = 0,5 do
				local item = caster:GetItemInSlot(item_slot)
				if item ~= nil then
					if item:GetAbilityName() == v1 then
						table.insert(composeItem,item)
						break
					end
				end
			end
		end
		
		if (#composeItem) == (#suit["Item"]) then
			caster:AddNewModifier(caster,nil,suit["buff"],{})
		end	
		return nil
	end )
	
end

function  item_set_04_011(event)

	local caster=event.caster
	if caster:HasModifier("modifers_item_set_04") then
		local enemies = FindUnitsInRadius( caster:GetTeamNumber(), caster:GetOrigin(), caster, 1800, DOTA_UNIT_TARGET_TEAM_FRIENDLY, DOTA_UNIT_TARGET_HERO, DOTA_UNIT_TARGET_FLAG_MAGIC_IMMUNE_ENEMIES, 0, false )
		for _,enemy in pairs(enemies) do
			if enemy:GetPrimaryAttribute()==0	 then
				enemy:Heal(enemy:GetStrength(), nil)
			end
			if enemy:GetPrimaryAttribute()==1	 then
				enemy:Heal(enemy:GetAgility(), nil)
			end
			if enemy:GetPrimaryAttribute()==2	 then
				enemy:Heal(enemy:GetIntellect(), nil)
			end
			local RemovePositiveBuffs = true
	        local RemoveDebuffs = false
	        local BuffsCreatedThisFrameOnly = false
	        local RemoveStuns = false
	        local RemoveExceptions = false
	        enemy:Purge( RemovePositiveBuffs, RemoveDebuffs, BuffsCreatedThisFrameOnly, RemoveStuns, RemoveExceptions )
	    end
	end
end

function  item_set_04_01(event)

	local caster=event.caster
	local ab= event.ability
	caster:EmitSound("DOTA_Item.ShivasGuard.Activate")
	local nFXIndex = ParticleManager:CreateParticle( "particles/items2_fx/shivas_guard_active.vpcf", PATTACH_ABSORIGIN_FOLLOW,  caster )
			ParticleManager:SetParticleControl( nFXIndex, 1, Vector( 1000,2,400 ) )
			ParticleManager:ReleaseParticleIndex( nFXIndex )
	

	local enemies = FindUnitsInRadius(caster:GetTeamNumber(), caster:GetOrigin(), nil, 1000,
                    DOTA_UNIT_TARGET_TEAM_ENEMY, DOTA_UNIT_TARGET_HERO+DOTA_UNIT_TARGET_BASIC,
                    DOTA_UNIT_TARGET_FLAG_MAGIC_IMMUNE_ENEMIES, FIND_CLOSEST, false)
	for _,enemy in pairs(enemies) do
		
		ab:ApplyDataDrivenModifier(caster, enemy, "modifier_item_set_05_01_debuff", nil)
		local damage = {
					victim = enemy,
					attacker = caster,
					damage = 20*caster:GetIntellect(),
					damage_type = DAMAGE_TYPE_MAGICAL,
					ability = ab,
				}
		ApplyDamage( damage )
    end
	
end

function  item_set_05_01(event)

	local caster=event.caster
	local ab= event.ability
	
		if caster:HasModifier("modifers_item_set_05") then	
		ab:ApplyDataDrivenModifier(caster, caster, "modifier_item_set_06_01_buff", nil)
	
	end
end
function  item_set_07_01(event)
	
	local caster=event.caster
	local target=event.target
	local ab= event.ability
	local i = 2
	if caster:HasModifier("modifers_item_set_07") then	
		i = 5
	end
	local damage = {
					victim = target,
					attacker = caster,
					damage = i*caster:GetAgility(),
					damage_type = DAMAGE_TYPE_PHYSICAL,
					ability = ab,
				}
	ApplyDamage( damage )
	
	
end


function  item_set_09_011(event)

	local caster=event.caster
	local ab= event.ability
	if caster:HasModifier("modifers_item_set_09") then	
	ab:ApplyDataDrivenModifier(caster, caster, "modifier_item_set_09_01_buff", nil)
	
	end
end

function item_set_09_01(event)
	local caster=event.caster
	local ab= event.ability
	local target=event.target
	local enemies = FindUnitsInRadius(caster:GetTeamNumber(), target:GetOrigin(), nil, 200,
                    DOTA_UNIT_TARGET_TEAM_ENEMY, DOTA_UNIT_TARGET_HERO+DOTA_UNIT_TARGET_BASIC,
                    DOTA_UNIT_TARGET_FLAG_MAGIC_IMMUNE_ENEMIES, FIND_CLOSEST, false)
	for _,enemy in pairs(enemies) do
		
		
		local damage = {
					victim = enemy,
					attacker = caster,
					damage = 2*caster:GetAttackDamage()+5*caster:GetStrength() ,
					damage_type = DAMAGE_TYPE_PHYSICAL,
					ability = ab,
				}
		ApplyDamage( damage )
    end
end
function item_set_09_01_str(event)
	local caster=event.caster
	local ability= event.ability
	local attributes = {}
	attributes["bfbtsll"] = 50
	AttributesSet(caster,attributes)
end
function item_set_09_01_str_remove(event)
	local caster=event.caster
	local ability= event.ability
	local attributes = {}
	attributes["bfbtsll"] = -50
	AttributesSet(caster,attributes)
end
function item_set_10_01( event )
	local caster=event.caster
	local ab= event.ability
	local target=event.target
	if RollPercentage(50) then
		local damage = {
						victim = target,
						attacker = caster,
						damage = 3000 ,
						damage_type = DAMAGE_TYPE_MAGICAL,
						ability = ab,
					}
			ApplyDamage( damage )
	end
end
function item_set_12_01_create( event )
	local caster=event.caster
	local ab= event.ability

	if caster:GetPrimaryAttribute()==0	 then
		ab:ApplyDataDrivenModifier(caster, caster, "modifier_item_set_12_01_aura_str", nil)
	end
	if caster:GetPrimaryAttribute()==1	 then
		ab:ApplyDataDrivenModifier(caster, caster, "modifier_item_set_12_01_aura_agi", nil)
	end
	if caster:GetPrimaryAttribute()==2	 then
		ab:ApplyDataDrivenModifier(caster, caster, "modifier_item_set_12_01_aura_int", nil)
	end
	
end
function item_set_12_01_destory( event )
	local caster=event.caster
	local ab= event.ability
	caster:RemoveModifierByName("modifier_item_set_12_01_aura_str")
	caster:RemoveModifierByName("modifier_item_set_12_01_aura_agi")
	caster:RemoveModifierByName("modifier_item_set_12_01_aura_int")
end

function item_set_12_02_create( event )
	local caster=event.caster
	local ab= event.ability
	local unitKey = tostring(EntityHelper.getEntityIndex(caster))
	if not caster.cas_table then
		caster.cas_table = {}
	end
	local netTable = caster.cas_table --服务端存储，避免使用getNetTable方法
	netTable["wlbjgl"] = netTable["wlbjgl"] + 3
	netTable["wlbjsh"] = netTable["wlbjsh"] +20
	netTable["mfbjgl"] = netTable["mfbjgl"] + 3
	netTable["mfbjsh"] = netTable["mfbjsh"] +20
	SetNetTableValue("UnitAttributes",unitKey,netTable)
	
end
function item_set_12_02_destory( event )
	local caster=event.caster
	local ab= event.ability
	local unitKey = tostring(EntityHelper.getEntityIndex(caster))
	if not caster.cas_table then
		caster.cas_table = {}
	end
	local netTable = caster.cas_table --服务端存储，避免使用getNetTable方法
	netTable["wlbjgl"] = netTable["wlbjgl"] - 3
	netTable["wlbjsh"] = netTable["wlbjsh"] -20
	netTable["mfbjgl"] = netTable["mfbjgl"] - 3
	netTable["mfbjsh"] = netTable["mfbjsh"] -20
	SetNetTableValue("UnitAttributes",unitKey,netTable)
end
function item_set_12_03_create( event )
	local caster=event.caster
	local ab= event.ability
	
	
end
function item_set_12_03_destory( event )
	local caster=event.caster
	local ab= event.ability
end

function item_set_14_01( event)
	local caster=event.caster
	local ab= event.ability
	local target=event.target
	
	local current_stack = target:GetModifierStackCount( "modifier_item_set_14_01_debuff", ab )
    
	if current_stack==0  then
		ab:ApplyDataDrivenModifier(caster, target, "modifier_item_set_14_01_debuff", nil)
	end
    
	if current_stack<20 then
		target:SetModifierStackCount( "modifier_item_set_14_01_debuff", ab, current_stack+1)
	end
	
	-- body
end
function item_set_14_02( event)
	local caster=event.caster
	local ab= event.ability
	local target=event.target
	
	local current_stack = target:GetModifierStackCount( "modifier_item_set_14_02_debuff", ab )
	if current_stack==0  then
		ab:ApplyDataDrivenModifier(caster, target, "modifier_item_set_14_02_debuff", nil)
	end
    
	if current_stack<12 then
		target:SetModifierStackCount( "modifier_item_set_14_02_debuff", ab, current_stack+1)
	end
    
	
	-- body
end
function  item_set_14_03(event)
	local caster=event.caster
	local ab= event.ability
	local target=event.target
	ab:ApplyDataDrivenModifier(caster, target, "modifier_item_set_14_03_debuff", nil)
end
function  item_set_14_03_setstr(event)
	local caster=event.caster
	local ab= event.ability
	if caster:GetPrimaryAttribute()==0	 then
		caster:ModifyStrength(100)
	end
	if caster:GetPrimaryAttribute()==1	 then
		caster:ModifyAgility(100)
	end
	if caster:GetPrimaryAttribute()==2	 then
		caster:ModifyIntellect(100)
	end
end
function item_set_15_01( event)
	local caster=event.caster
	local ab= event.ability
	if caster:HasModifier("modifers_item_set_15") then
		local enemies = FindUnitsInRadius( caster:GetTeamNumber(), caster:GetOrigin(), caster, 1200, DOTA_UNIT_TARGET_TEAM_FRIENDLY, DOTA_UNIT_TARGET_HERO, DOTA_UNIT_TARGET_FLAG_MAGIC_IMMUNE_ENEMIES, 0, false )
		for _,enemy in pairs(enemies) do
			ab:ApplyDataDrivenModifier(caster, enemy, "modifier_item_set_15_01_buff", nil)	
		end
	end
end

function item_set_16_01( event)
	local caster=event.caster
	local ab= event.ability
	local target=event.target
	local current_stack = target:GetModifierStackCount( "modifier_item_set_16_01_debuff", ab )
    if current_stack==0  then
    	ab:ApplyDataDrivenModifier(caster, target, "modifier_item_set_16_01_debuff", nil)
    	target:SetModifierStackCount( "modifier_item_set_16_01_debuff", ab, 1)	
    	
    else
    	if current_stack<=15 then
        	target:SetModifierStackCount( "modifier_item_set_16_01_debuff", ab, current_stack+1)
    	end
    end

    local current_stack = target:GetModifierStackCount( "modifier_item_set_16_01_debuff", ab )
    local damage = {
						victim = target,
						attacker = caster,
						damage = 200*current_stack,
						damage_type = DAMAGE_TYPE_PHYSICAL,
						ability = ab,
					}
			ApplyDamage( damage )
	-- body
end


function item_set_16_01_addmain( event)
	local caster=event.caster
	local ab= event.ability
	if caster:GetPrimaryAttribute()==0	 then
		ab:ApplyDataDrivenModifier(caster, caster, "modifier_item_set_16_01_str", nil)
		
	end
	if caster:GetPrimaryAttribute()==1	 then
		ab:ApplyDataDrivenModifier(caster, caster, "modifier_item_set_16_01_agi", nil)
	end
	if caster:GetPrimaryAttribute()==2	 then
		ab:ApplyDataDrivenModifier(caster, caster, "modifier_item_set_16_01_int", nil)
		
	end
	
	
	
end
function item_set_16_01_removemain( event)
	local caster=event.caster
	local ab= event.ability
	caster:RemoveModifierByName("modifier_item_set_16_01_agi")
	caster:RemoveModifierByName("modifier_item_set_16_01_int")
	caster:RemoveModifierByName("modifier_item_set_16_01_str")
end
function item_set_16_02_addmain( event)
	local caster=event.caster
	local ab= event.ability
	if caster:GetPrimaryAttribute()==0	 then
		ab:ApplyDataDrivenModifier(caster, caster, "modifier_item_set_16_02_str", nil)
		
	end
	if caster:GetPrimaryAttribute()==1	 then
		ab:ApplyDataDrivenModifier(caster, caster, "modifier_item_set_16_02_agi", nil)
	end
	if caster:GetPrimaryAttribute()==2	 then
		ab:ApplyDataDrivenModifier(caster, caster, "modifier_item_set_16_02_int", nil)
		
	end
	
	
	
end
function item_set_16_02_removemain( event)
	local caster=event.caster
	local ab= event.ability
	caster:RemoveModifierByName("modifier_item_set_16_02_agi")
	caster:RemoveModifierByName("modifier_item_set_16_02_int")
	caster:RemoveModifierByName("modifier_item_set_16_02_str")
end
function item_set_16_03_addmain( event)
	local caster=event.caster
	local ab= event.ability
	if caster:GetPrimaryAttribute()==0	 then
		ab:ApplyDataDrivenModifier(caster, caster, "modifier_item_set_16_03_str", nil)
		
	end
	if caster:GetPrimaryAttribute()==1	 then
		ab:ApplyDataDrivenModifier(caster, caster, "modifier_item_set_16_03_agi", nil)
	end
	if caster:GetPrimaryAttribute()==2	 then
		ab:ApplyDataDrivenModifier(caster, caster, "modifier_item_set_16_03_int", nil)
		
	end
end
function item_set_16_03_removemain( event)
	local caster=event.caster
	local ab= event.ability
	caster:RemoveModifierByName("modifier_item_set_16_03_agi")
	caster:RemoveModifierByName("modifier_item_set_16_03_int")
	caster:RemoveModifierByName("modifier_item_set_16_03_str")
end
function item_set_16_01_spell( event)
	local caster=event.caster
	local ab= event.ability
	local target=event.target
	if caster:HasModifier("modifers_item_set_16") then
		ab:ApplyDataDrivenModifier(caster, caster, "modifier_item_set_16_01_buff", nil)
	end


end

function item_set_16_02_stackcount(event)
	local caster=event.caster
	local ability= event.ability
	
    local max_souls = 15
	
    -- Check if the hero already has the modifier
	local current_stack = caster:GetModifierStackCount( "modifier_item_set_16_02_buff", ability )
	
	if current_stack==0 then
        ability:ApplyDataDrivenModifier(caster, caster, "modifier_item_set_16_02_buff", {duration=3})
        
    end

    -- Set the stack up to max_souls
    if current_stack  <= max_souls then
        caster:SetModifierStackCount( "modifier_item_set_16_02_buff", ability, current_stack+1)
    else
        caster:SetModifierStackCount( "modifier_item_set_16_02_buff", ability, max_souls )
    end
end

function item_set_16_03_stackcount(event)
	local caster=event.caster
	local ability= event.ability
	
    local max_souls = 15
	
    -- Check if the hero already has the modifier
	local current_stack = caster:GetModifierStackCount( "modifier_item_set_16_03_buff", ability )
	
	if current_stack==0 then
        ability:ApplyDataDrivenModifier(caster, caster, "modifier_item_set_16_03_buff", {duration=3})
    end

    -- Set the stack up to max_souls
    if current_stack  <= max_souls then
        caster:SetModifierStackCount( "modifier_item_set_16_03_buff", ability, current_stack+1)
    else
        caster:SetModifierStackCount( "modifier_item_set_16_03_buff", ability, max_souls )
    end
end

function modifier_item_set_15_01_addleveldamage(event)
	local caster=event.caster
	local ability= event.ability
	local bonus_spell_level= ability:GetSpecialValueFor("bonus_spell_level")
	local unitKey = tostring(EntityHelper.getEntityIndex(caster))
	if not caster.cas_table then
		caster.cas_table = {}
	end
	local netTable = caster.cas_table --服务端存储，避免使用getNetTable方法
	netTable["grjndj"] = netTable["grjndj"] + bonus_spell_level
	SetNetTableValue("UnitAttributes",unitKey,netTable)

end
function modifier_item_set_15_01_removeleveldamage(event)
	local caster=event.caster
	local ability= event.ability
	local bonus_spell_level= ability:GetSpecialValueFor("bonus_spell_level")
	local unitKey = tostring(EntityHelper.getEntityIndex(caster))
	if not caster.cas_table then
		caster.cas_table = {}
	end
	local netTable = caster.cas_table --服务端存储，避免使用getNetTable方法
	netTable["grjndj"] = netTable["grjndj"] - bonus_spell_level
	SetNetTableValue("UnitAttributes",unitKey,netTable)
end

function modifier_item_set_15_01_buff_addleveldamage(event)
	local caster=event.caster
	local ability= event.ability
	--local bonus_spell_level= ability:GetSpecialValueFor("bonus_spell_level")
	local unitKey = tostring(EntityHelper.getEntityIndex(caster))
	if not caster.cas_table then
		caster.cas_table = {}
	end
	local netTable = caster.cas_table --服务端存储，避免使用getNetTable方法
	netTable["grjndj"] = netTable["grjndj"] +2
	SetNetTableValue("UnitAttributes",unitKey,netTable)
end
function modifier_item_set_15_01_buff_removeleveldamage(event)
	local caster=event.caster
	local ability= event.ability
	local unitKey = tostring(EntityHelper.getEntityIndex(caster))
	if not caster.cas_table then
		caster.cas_table = {}
	end
	local netTable = caster.cas_table --服务端存储，避免使用getNetTable方法
	netTable["grjndj"] = netTable["grjndj"] -2
	SetNetTableValue("UnitAttributes",unitKey,netTable)
end

function item_set_14_01_setmain(event)
	local caster=event.caster
	local ability= event.ability
	local percent=ability:GetSpecialValueFor("bonus_mainbonus_percent")
	if caster:GetPrimaryAttribute()==0	 then
		local attributes = {}
		attributes["bfbtsll"] = percent
		AttributesSet(caster,attributes)
	end
	if caster:GetPrimaryAttribute()==1	 then
		local attributes = {}
		attributes["bfbtsmj"] = percent
		AttributesSet(caster,attributes)
	end
	if caster:GetPrimaryAttribute()==2	 then
		local attributes = {}
		attributes["bfbtszl"] = percent
		AttributesSet(caster,attributes)
	end
end
function item_set_14_01_removemain(event)
	local caster=event.caster
	local ability= event.ability
	local percent=-ability:GetSpecialValueFor("bonus_mainbonus_percent")
	if caster:GetPrimaryAttribute()==0	 then
		local attributes = {}
		attributes["bfbtsll"] = percent
		AttributesSet(caster,attributes)
	end
	if caster:GetPrimaryAttribute()==1	 then
		local attributes = {}
		attributes["bfbtsmj"] = percent
		AttributesSet(caster,attributes)
	end
	if caster:GetPrimaryAttribute()==2	 then
		local attributes = {}
		attributes["bfbtszl"] = percent
		AttributesSet(caster,attributes)
	end
end
function item_set_14_02_setmain(event)
	local caster=event.caster
	local ability= event.ability
	local percent=ability:GetSpecialValueFor("bonus_mainbonus_percent")
	if caster:GetPrimaryAttribute()==0	 then
		local attributes = {}
		attributes["bfbtsll"] = percent
		AttributesSet(caster,attributes)
	end
	if caster:GetPrimaryAttribute()==1	 then
		local attributes = {}
		attributes["bfbtsmj"] = percent
		AttributesSet(caster,attributes)
	end
	if caster:GetPrimaryAttribute()==2	 then
		local attributes = {}
		attributes["bfbtszl"] = percent
		AttributesSet(caster,attributes)
	end
end
function item_set_14_02_removemain(event)
	local caster=event.caster
	local ability= event.ability
	local percent=-ability:GetSpecialValueFor("bonus_mainbonus_percent")
	if caster:GetPrimaryAttribute()==0	 then
		local attributes = {}
		attributes["bfbtsll"] = percent
		AttributesSet(caster,attributes)
	end
	if caster:GetPrimaryAttribute()==1	 then
		local attributes = {}
		attributes["bfbtsmj"] = percent
		AttributesSet(caster,attributes)
	end
	if caster:GetPrimaryAttribute()==2	 then
		local attributes = {}
		attributes["bfbtszl"] = percent
		AttributesSet(caster,attributes)
	end
end
function item_set_14_03_setmain(event)
	local caster=event.caster
	local ability= event.ability
	local percent=ability:GetSpecialValueFor("bonus_mainbonus_percent")
	if caster:GetPrimaryAttribute()==0	 then
		local attributes = {}
		attributes["bfbtsll"] = percent
		AttributesSet(caster,attributes)
	end
	if caster:GetPrimaryAttribute()==1	 then
		local attributes = {}
		attributes["bfbtsmj"] = percent
		AttributesSet(caster,attributes)
	end
	if caster:GetPrimaryAttribute()==2	 then
		local attributes = {}
		attributes["bfbtszl"] = percent
		AttributesSet(caster,attributes)
	end
end
function item_set_14_03_removemain(event)
	local caster=event.caster
	local ability= event.ability
	local percent=-ability:GetSpecialValueFor("bonus_mainbonus_percent")
	if caster:GetPrimaryAttribute()==0	 then
		local attributes = {}
		attributes["bfbtsll"] = percent
		AttributesSet(caster,attributes)
	end
	if caster:GetPrimaryAttribute()==1	 then
		local attributes = {}
		attributes["bfbtsmj"] = percent
		AttributesSet(caster,attributes)
	end
	if caster:GetPrimaryAttribute()==2	 then
		local attributes = {}
		attributes["bfbtszl"] = percent
		AttributesSet(caster,attributes)
	end
end
function item_set_13_01_setmain( event)
	local caster=event.caster
	local ab= event.ability
	if caster:GetPrimaryAttribute()==0	 then
		ab:ApplyDataDrivenModifier(caster, caster, "modifier_item_set_13_01_str", nil)
		
	end
	if caster:GetPrimaryAttribute()==1	 then
		ab:ApplyDataDrivenModifier(caster, caster, "modifier_item_set_13_01_agi", nil)
	end
	if caster:GetPrimaryAttribute()==2	 then
		ab:ApplyDataDrivenModifier(caster, caster, "modifier_item_set_13_01_int", nil)
		
	end
	local unitKey = tostring(EntityHelper.getEntityIndex(caster))
	if not caster.cas_table then
		caster.cas_table = {}
	end
	local netTable = caster.cas_table --服务端存储，避免使用getNetTable方法
	netTable["wlbjgl"] = netTable["wlbjgl"] + 5
	netTable["mfbjgl"] = netTable["mfbjgl"] + 5
	SetNetTableValue("UnitAttributes",unitKey,netTable)

end
function item_set_13_01_removemain( event)
	local caster=event.caster
	local ab= event.ability
	local modifer=event.modifername
	caster:RemoveModifierByName("modifier_item_set_13_01_str")
	caster:RemoveModifierByName("modifier_item_set_13_01_int")
	caster:RemoveModifierByName("modifier_item_set_13_01_agi")
	local unitKey = tostring(EntityHelper.getEntityIndex(caster))
	if not caster.cas_table then
		caster.cas_table = {}
	end
	local netTable = caster.cas_table --服务端存储，避免使用getNetTable方法
	netTable["wlbjgl"] = netTable["wlbjgl"] - 5
	netTable["mfbjgl"] = netTable["mfbjgl"] - 5
	SetNetTableValue("UnitAttributes",unitKey,netTable)
end

function item_set_13_02_setmain( event)
	local caster=event.caster
	local ab= event.ability
	if caster:GetPrimaryAttribute()==0	 then
		ab:ApplyDataDrivenModifier(caster, caster, "modifier_item_set_13_02_str", nil)
		
	end
	if caster:GetPrimaryAttribute()==1	 then
		ab:ApplyDataDrivenModifier(caster, caster, "modifier_item_set_13_02_agi", nil)
	end
	if caster:GetPrimaryAttribute()==2	 then
		ab:ApplyDataDrivenModifier(caster, caster, "modifier_item_set_13_02_int", nil)
		
	end
	local unitKey = tostring(EntityHelper.getEntityIndex(caster))
	if not caster.cas_table then
		caster.cas_table = {}
	end
	local netTable = caster.cas_table --服务端存储，避免使用getNetTable方法
	netTable["wlbjgl"] = netTable["wlbjgl"] + 5
	netTable["wlbjsh"] = netTable["wlbjsh"] + 50
	netTable["mfbjgl"] = netTable["mfbjgl"] + 5
	netTable["mfbjsh"] = netTable["mfbjsh"] + 50
	
	SetNetTableValue("UnitAttributes",unitKey,netTable)

end
function item_set_13_02_removemain( event)
	local caster=event.caster
	local ab= event.ability
	local modifer=event.modifername
	caster:RemoveModifierByName("modifier_item_set_13_02_str")
	caster:RemoveModifierByName("modifier_item_set_13_02_int")
	caster:RemoveModifierByName("modifier_item_set_13_02_agi")
	
	local unitKey = tostring(EntityHelper.getEntityIndex(caster))
	if not caster.cas_table then
		caster.cas_table = {}
	end
	local netTable = caster.cas_table --服务端存储，避免使用getNetTable方法
	netTable["wlbjgl"] = netTable["wlbjgl"] - 5
	netTable["wlbjsh"] = netTable["wlbjsh"] - 50
	netTable["mfbjgl"] = netTable["mfbjgl"] - 5
	netTable["mfbjsh"] = netTable["mfbjsh"] - 50
	
	SetNetTableValue("UnitAttributes",unitKey,netTable)
end

function item_set_13_03_setmain( event)
	local caster=event.caster
	local ab= event.ability
	if caster:GetPrimaryAttribute()==0	 then
		ab:ApplyDataDrivenModifier(caster, caster, "modifier_item_set_13_03_str", nil)
		
	end
	if caster:GetPrimaryAttribute()==1	 then
		ab:ApplyDataDrivenModifier(caster, caster, "modifier_item_set_13_03_agi", nil)
	end
	if caster:GetPrimaryAttribute()==2	 then
		ab:ApplyDataDrivenModifier(caster, caster, "modifier_item_set_13_03_int", nil)
		
	end


end
function item_set_13_03_removemain( event)
	local caster=event.caster
	local ab= event.ability
	local modifer=event.modifername
	caster:RemoveModifierByName("modifier_item_set_13_03_str")
	caster:RemoveModifierByName("modifier_item_set_13_03_int")
	caster:RemoveModifierByName("modifier_item_set_13_03_agi")
	
end

function item_set_09_01_setstr( event)
	local caster=event.caster
	local ability= event.ability
	local percent=ability:GetSpecialValueFor("bonus_strength_percent")
	local attributes = {}
	attributes["bfbtsll"] = percent
	AttributesSet(caster,attributes)

end
function item_set_09_01_removestr( event)
	local caster=event.caster
	local ability= event.ability
	local percent=-ability:GetSpecialValueFor("bonus_strength_percent")
	local attributes = {}
	attributes["bfbtsll"] = percent
	AttributesSet(caster,attributes)
end
function item_set_09_02_set( event)
	local caster=event.caster
	local ab= event.ability
	local unitKey = tostring(EntityHelper.getEntityIndex(caster))
	if not caster.cas_table then
		caster.cas_table = {}
	end
	local netTable = caster.cas_table --服务端存储，避免使用getNetTable方法
	netTable["wlbjgl"] = netTable["wlbjgl"] +10
	SetNetTableValue("UnitAttributes",unitKey,netTable)
end
function item_set_09_02_remove( event)
	local caster=event.caster
	local ab= event.ability
	local unitKey = tostring(EntityHelper.getEntityIndex(caster))
	if not caster.cas_table then
		caster.cas_table = {}
	end
	local netTable = caster.cas_table --服务端存储，避免使用getNetTable方法
	netTable["wlbjgl"] = netTable["wlbjgl"] - 10
	SetNetTableValue("UnitAttributes",unitKey,netTable)
	
end

function item_set_09_03_set( event)
	local caster=event.caster
	local ab= event.ability
	local unitKey = tostring(EntityHelper.getEntityIndex(caster))
	if not caster.cas_table then
		caster.cas_table = {}
	end
	local netTable = caster.cas_table --服务端存储，避免使用getNetTable方法
	netTable["wlbjsh"] = netTable["wlbjsh"] +50
	SetNetTableValue("UnitAttributes",unitKey,netTable)
end
function item_set_09_03_remove( event)
	local caster=event.caster
	local ab= event.ability
	local unitKey = tostring(EntityHelper.getEntityIndex(caster))
	if not caster.cas_table then
		caster.cas_table = {}
	end
	local netTable = caster.cas_table --服务端存储，避免使用getNetTable方法
	netTable["wlbjsh"] = netTable["wlbjsh"]-50
	SetNetTableValue("UnitAttributes",unitKey,netTable)
	
end

function item_set_08_01_set( event)
	local caster=event.caster
	local ab= event.ability
	local unitKey = tostring(EntityHelper.getEntityIndex(caster))
	if not caster.cas_table then
		caster.cas_table = {}
	end
	local netTable = caster.cas_table --服务端存储，避免使用getNetTable方法
	netTable["mfbjgl"] = netTable["mfbjgl"] + 4 
	netTable["mfbjsh"] = netTable["mfbjsh"] +10
	SetNetTableValue("UnitAttributes",unitKey,netTable)
end
function item_set_08_01_remove( event)
	local caster=event.caster
	local ab= event.ability
	local unitKey = tostring(EntityHelper.getEntityIndex(caster))
	if not caster.cas_table then
		caster.cas_table = {}
	end
	local netTable = caster.cas_table --服务端存储，避免使用getNetTable方法
	netTable["mfbjgl"] = netTable["mfbjgl"] - 4 
	netTable["mfbjsh"] = netTable["mfbjsh"] -10
	SetNetTableValue("UnitAttributes",unitKey,netTable)
	
end

function item_set_03_01(event)
	local caster=event.caster
	local ab= event.ability
	if caster:HasModifier("modifers_item_set_03") then
		local enemies = FindUnitsInRadius( caster:GetTeamNumber(), caster:GetOrigin(), caster, 1500, DOTA_UNIT_TARGET_TEAM_FRIENDLY, DOTA_UNIT_TARGET_HERO, DOTA_UNIT_TARGET_FLAG_MAGIC_IMMUNE_ENEMIES, 0, false )
		for _,enemy in pairs(enemies) do
			local RemovePositiveBuffs = false
			local RemoveDebuffs = true
			local BuffsCreatedThisFrameOnly = false
			local RemoveStuns = true
			local RemoveExceptions = false
			enemy:Purge( RemovePositiveBuffs, RemoveDebuffs, BuffsCreatedThisFrameOnly, RemoveStuns, RemoveExceptions)
			enemy:Heal(caster:GetPrimaryStatValue()*5, caster)
			local p = ParticleManager:CreateParticle( "particles/units/heroes/hero_tidehunter/tide_tnt_backstroke_spray.vpcf", PATTACH_ABSORIGIN_FOLLOW, enemy )
			ParticleManager:SetParticleControl( p, 0, enemy:GetAbsOrigin())
		end
	end
end

function AttributesSet(unit,attributes)
	if unit and attributes then
		local netTable = unit.cas_table
		if not netTable then
			netTable = {}
			unit.cas_table = netTable
		end
		
		for key, value in pairs(attributes) do
			if netTable[key] then
				netTable[key]  = netTable[key]  + value
			else
				netTable[key]  = value
			end
			if netTable[key]<0 then
				netTable[key]=0
			end
			if key == "treasure" then
				local PlayerID = unit:GetPlayerOwnerID()
				SetNetTableValue("PlayerInfo","treasure_"..PlayerID,{max=netTable[key]})
			end
		end
		unit.cas_table=netTable
		SetNetTableValue("UnitAttributes",tostring(EntityHelper.getEntityIndex(unit)),netTable)
	end
end

function AttributesSet2(unit,attributes)
	if unit and attributes then
		local netTable = unit.cas_table
		if not netTable then
			netTable = {}
			unit.cas_table = netTable
		end
		
		for key, value in pairs(attributes) do
			if unit[key] then
				unit[key]  = unit[key]  + value
				netTable[key] = unit[key]
			else
				unit[key]  = value
				netTable[key] = unit[key]
			end
		end
		unit.cas_table=netTable
		SetNetTableValue("UnitAttributes",tostring(EntityHelper.getEntityIndex(unit)),netTable)
	end
end
